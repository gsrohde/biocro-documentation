<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BioCro: /github/workspace/source/src/module_library/BioCro.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('BioCro_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">BioCro.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="AuxBioCro_8h_source.html">AuxBioCro.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for BioCro.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="BioCro_8h__incl.png" border="0" usemap="#_2github_2workspace_2source_2src_2module__library_2BioCro_8h" alt=""/></div>
<map name="_2github_2workspace_2source_2src_2module__library_2BioCro_8h" id="_2github_2workspace_2source_2src_2module__library_2BioCro_8h">
<area shape="rect" title=" " alt="" coords="5,5,189,47"/>
<area shape="rect" href="AuxBioCro_8h.html" title=" " alt="" coords="51,95,144,121"/>
<area shape="rect" title=" " alt="" coords="74,169,121,196"/>
</map>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="BioCro_8h__dep__incl.png" border="0" usemap="#_2github_2workspace_2source_2src_2module__library_2BioCro_8hdep" alt=""/></div>
<map name="_2github_2workspace_2source_2src_2module__library_2BioCro_8hdep" id="_2github_2workspace_2source_2src_2module__library_2BioCro_8hdep">
<area shape="rect" title=" " alt="" coords="461,5,645,47"/>
<area shape="rect" href="AuxBioCro_8cpp.html" title=" " alt="" coords="5,102,225,143"/>
<area shape="rect" href="c3__leaf__photosynthesis_8h.html" title=" " alt="" coords="250,95,421,151"/>
<area shape="rect" href="c3CanAC_8cpp.html" title=" " alt="" coords="445,102,660,143"/>
<area shape="rect" href="c3EvapoTrans_8cpp.html" title=" " alt="" coords="685,102,927,143"/>
<area shape="rect" href="CanAC_8cpp.html" title=" " alt="" coords="951,102,1151,143"/>
<area shape="rect" href="module__wrapper__factory_8cpp.html" title=" " alt="" coords="247,303,424,359"/>
<area shape="rect" href="multilayer__c3__canopy_8h.html" title=" " alt="" coords="307,199,497,255"/>
</map>
</div>
</div>
<p><a href="BioCro_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structLight__model.html">Light_model</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a81eccf5a903a575f17d799d959397f61"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#a81eccf5a903a575f17d799d959397f61">cos_zenith_angle</a> (const double latitude, const int day_of_year, const double hour_of_day)</td></tr>
<tr class="separator:a81eccf5a903a575f17d799d959397f61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a799eb2bb22fdef53d633f44a4c0ef1b9"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structCan__Str.html">Can_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#a799eb2bb22fdef53d633f44a4c0ef1b9">CanAC</a> (double LAI, int DOY, double hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Alpha, double Kparm, double beta, double Rd, double Catm, double b0, double b1, double theta, double kd, double chil, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double upperT, double lowerT, const struct <a class="el" href="structnitroParms.html">nitroParms</a> &amp;nitroP, double leafwidth, int eteq, double StomataWS, int water_stress_approach)</td></tr>
<tr class="separator:a799eb2bb22fdef53d633f44a4c0ef1b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a542c69a99fb2b34f3be5a4d596de5f3a"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structCan__Str.html">Can_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#a542c69a99fb2b34f3be5a4d596de5f3a">c3CanAC</a> (double LAI, int DOY, double hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Jmax, double Rd, double Catm, double o2, double b0, double b1, double theta, double kd, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double chil, double StomataWS, double growth_respiration_fraction, int water_stress_approach, double electrons_per_carboxylation, double electrons_per_oxygenation)</td></tr>
<tr class="separator:a542c69a99fb2b34f3be5a4d596de5f3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb35169469ef33705592a28743d105bf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#aeb35169469ef33705592a28743d105bf">resp</a> (double comp, double mrc, double temp)</td></tr>
<tr class="separator:aeb35169469ef33705592a28743d105bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5039fd6db860b5b611fb3c90b00ef7e8"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structws__str.html">ws_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#a5039fd6db860b5b611fb3c90b00ef7e8">watstr</a> (double precipit, double evapo, double cws, double soildepth, double fieldc, double wiltp, double phi1, double phi2, double soil_saturation_capacity, double soil_sand_content, double Ks, double air_entry, double b)</td></tr>
<tr class="separator:a5039fd6db860b5b611fb3c90b00ef7e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6f4cf8654e6db407d4d453834c1807c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#ad6f4cf8654e6db407d4d453834c1807c">SoilEvapo</a> (double LAI, double k, double AirTemp, double DirectRad, double awc, double fieldc, double wiltp, double winds, double RelH, double rsec, double soil_clod_size, double soil_reflectance, double soil_transmission, double specific_heat, double stefan_boltzman)</td></tr>
<tr class="separator:ad6f4cf8654e6db407d4d453834c1807c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a240cad92527a319dd4e8e0d32cd821e6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsoilML__str.html">soilML_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#a240cad92527a319dd4e8e0d32cd821e6">soilML</a> (double precipit, double transp, double *cws, double soildepth, double *depths, double soil_field_capacity, double soil_wilting_point, double soil_saturation_capacity, double soil_air_entry, double soil_saturated_conductivity, double soil_b_coefficient, double soil_sand_content, double phi1, double phi2, int wsFun, int layers, double rootDB, double LAI, double k, double AirTemp, double IRad, double winds, double RelH, int hydrDist, double rfl, double rsec, double rsdf, double soil_clod_size, double soil_reflectance, double soil_transmission, double specific_heat, double stefan_boltzman)</td></tr>
<tr class="separator:a240cad92527a319dd4e8e0d32cd821e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4d2cdd07093428af4830f4c8afd660c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#aa4d2cdd07093428af4830f4c8afd660c">RHprof</a> (double RH, int nlayers, double *relative_humidity_profile)</td></tr>
<tr class="separator:aa4d2cdd07093428af4830f4c8afd660c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5f0fc680176f312e47c32701ce779f7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#ad5f0fc680176f312e47c32701ce779f7">WINDprof</a> (double WindSpeed, double LAI, int nlayers, double *wind_speed_profile)</td></tr>
<tr class="separator:ad5f0fc680176f312e47c32701ce779f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae405c9aa7474b930996999660001cd00"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structLight__profile.html">Light_profile</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#ae405c9aa7474b930996999660001cd00">sunML</a> (double Idir, double Idiff, double LAI, int nlayers, double cosTheta, double kd, double chil, double heightf)</td></tr>
<tr class="separator:ae405c9aa7474b930996999660001cd00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d896aaaf32c2c9dfce1a53f7d22a884"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structLight__model.html">Light_model</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#a1d896aaaf32c2c9dfce1a53f7d22a884">lightME</a> (double lat, int DOY, double td)</td></tr>
<tr class="separator:a1d896aaaf32c2c9dfce1a53f7d22a884"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1f878344b2d2444f096bd0da2cb9f24"><td class="memItemLeft" align="right" valign="top">struct FL_str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a> (double Lig, double Nit)</td></tr>
<tr class="separator:ab1f878344b2d2444f096bd0da2cb9f24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f6a4f8b6e407fdca09efcebc32bf86c"><td class="memItemLeft" align="right" valign="top">struct flow_str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a> (double *SC, double CNratio, double A, double Lc, double Tm, double <a class="el" href="BioCro_8h.html#aeb35169469ef33705592a28743d105bf">resp</a>, int kno, double Ks[8])</td></tr>
<tr class="separator:a3f6a4f8b6e407fdca09efcebc32bf86c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1061dc2ec428954d1e4fd2abd8e17957"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#a1061dc2ec428954d1e4fd2abd8e17957">AbiotEff</a> (double smoist, double stemp)</td></tr>
<tr class="separator:a1061dc2ec428954d1e4fd2abd8e17957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae32da4734d9888b3d3b1fda9480a129"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structET__Str.html">ET_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#aae32da4734d9888b3d3b1fda9480a129">EvapoTrans2</a> (double Rad, double Iave, double Airtemperature, double RH, double WindSpeed, double LeafAreaIndex, double CanopyHeight, double stomatacond, double leafw, int eteq)</td></tr>
<tr class="separator:aae32da4734d9888b3d3b1fda9480a129"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fa022454f0de8f427c38ad0cbec1314"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structET__Str.html">ET_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BioCro_8h.html#a6fa022454f0de8f427c38ad0cbec1314">c3EvapoTrans</a> (double Itot, double Airtemperature, double RH, double WindSpeed, double CanopyHeight, double stomtal_conductance)</td></tr>
<tr class="separator:a6fa022454f0de8f427c38ad0cbec1314"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1061dc2ec428954d1e4fd2abd8e17957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1061dc2ec428954d1e4fd2abd8e17957">&#9670;&nbsp;</a></span>AbiotEff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double AbiotEff </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>smoist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stemp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a542c69a99fb2b34f3be5a4d596de5f3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a542c69a99fb2b34f3be5a4d596de5f3a">&#9670;&nbsp;</a></span>c3CanAC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structCan__Str.html">Can_Str</a> c3CanAC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>o2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomataWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>growth_respiration_fraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>water_stress_approach</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>electrons_per_carboxylation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>electrons_per_oxygenation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="c3CanAC_8cpp_source.html#l00001">1</a> of file <a class="el" href="c3CanAC_8cpp_source.html">c3CanAC.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <span class="keyword">struct </span><a class="code" href="structLight__model.html">Light_model</a> light_model = <a class="code" href="AuxBioCro_8cpp.html#ac5f31df2b025300918f031bf8f1e51d9">lightME</a>(lat, DOY, hr);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">double</span> Idir = light_model.<a class="code" href="structLight__model.html#a29f813f0ce340f3d02748daffbec5200">direct_irradiance_fraction</a> * solarR;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordtype">double</span> Idiff = light_model.<a class="code" href="structLight__model.html#a5ecfb901306b14488b8b3e2e851f63b6">diffuse_irradiance_fraction</a> * solarR;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">double</span> cosTh = light_model.<a class="code" href="structLight__model.html#a8ad7918d4aada10f0c64e073da9c4ff4">cosine_zenith_angle</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keyword">struct </span><a class="code" href="structLight__profile.html">Light_profile</a> light_profile = <a class="code" href="AuxBioCro_8cpp.html#a29eacaa214f1899c9df199ac80d0e1ca">sunML</a>(Idir, Idiff, LAI, nlayers, cosTh, kd, chil, heightf);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//    if(LAI &lt; 0) throw std::range_error(&quot;Thrown in c3CanAC: LAI is negative.&quot;); MLM removed this error message 04/22/2020; can cause issues with integration</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">double</span> LAIc = LAI / nlayers;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">double</span> relative_humidity_profile[nlayers];</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="AuxBioCro_8cpp.html#aa4d2cdd07093428af4830f4c8afd660c">RHprof</a>(RH, nlayers, relative_humidity_profile);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">double</span> wind_speed_profile[nlayers];</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="AuxBioCro_8cpp.html#ad5f0fc680176f312e47c32701ce779f7">WINDprof</a>(WindSpeed, LAI, nlayers, wind_speed_profile);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">double</span> leafN_profile[nlayers];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="AuxBioCro_8cpp.html#a2905c23b422ad454d9577841ca594d0d">LNprof</a>(leafN, LAI, nlayers, kpLN, leafN_profile);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">double</span> CanopyA = 0.0, CanopyT = 0.0, GCanopyA = 0.0;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nlayers; ++i)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordtype">int</span> current_layer = nlayers - 1 - i;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                <span class="keywordtype">double</span> leafN_lay = leafN_profile[current_layer];</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordtype">double</span> vmax1;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">if</span> (lnfun == 0) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                        vmax1 = Vmax;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                        vmax1 = leafN_lay * lnb1 + lnb0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordtype">double</span> relative_humidity = relative_humidity_profile[current_layer];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordtype">double</span> layer_wind_speed = wind_speed_profile[current_layer];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordtype">double</span> IDir = light_profile.<a class="code" href="structLight__profile.html#a2f8231e1e3f6b0c04e8a08ddcc419e03">direct_irradiance</a>[current_layer];  <span class="comment">// micromole / m^2 / s</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordtype">double</span> Itot = light_profile.<a class="code" href="structLight__profile.html#a424cf9cc81031798184256d14a08786a">total_irradiance</a>[current_layer];  <span class="comment">// micromole / m^2 / s</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordtype">double</span> pLeafsun = light_profile.<a class="code" href="structLight__profile.html#a5ab1c660a6d5af30163325103043a419">sunlit_fraction</a>[current_layer];  <span class="comment">// dimensionless</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordtype">double</span> CanHeight = light_profile.<a class="code" href="structLight__profile.html#ab9551f243ec3ef975ebb13d1566aa75a">height</a>[current_layer];  <span class="comment">// meters</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordtype">double</span> Leafsun = LAIc * pLeafsun;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordtype">double</span> stomatal_conductance_direct = <a class="code" href="c3photo_8cpp.html#a4889758656320bc9290988b4dd5dcec2">c3photoC</a>(IDir, air_temperature, relative_humidity, vmax1, Jmax, Rd, b0, b1, Catm, o2, theta, StomataWS, water_stress_approach, electrons_per_carboxylation, electrons_per_oxygenation).<a class="code" href="structc3__str.html#a2fcc3787ac1ca5dd5be990fc00fb92f6">Gs</a>;  <span class="comment">// mmol / m^2 / s. Estimate stomatal_conductance by assuming the leaf has the same temperature as the air.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keyword">struct </span><a class="code" href="structET__Str.html">ET_Str</a> et_direct = <a class="code" href="BioCro_8h.html#a6fa022454f0de8f427c38ad0cbec1314">c3EvapoTrans</a>(Itot, air_temperature, relative_humidity, layer_wind_speed, CanHeight, stomatal_conductance_direct);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordtype">double</span> leaf_temperature_Idir = air_temperature + et_direct.<a class="code" href="structET__Str.html#af1313b200fdfaf71c6d4ee070ddeaf8c">Deltat</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keyword">struct </span><a class="code" href="structc3__str.html">c3_str</a> temp_photo_results = <a class="code" href="c3photo_8cpp.html#a4889758656320bc9290988b4dd5dcec2">c3photoC</a>(IDir, leaf_temperature_Idir, relative_humidity, vmax1, Jmax, Rd, b0, b1, Catm, o2, theta, StomataWS, water_stress_approach, electrons_per_carboxylation, electrons_per_oxygenation);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordtype">double</span> AssIdir = temp_photo_results.<a class="code" href="structc3__str.html#a859d76f4c4e8c6a96e34e9b99f2857dc">Assim</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordtype">double</span> GAssIdir = temp_photo_results.<a class="code" href="structc3__str.html#a0d2c3391dcf87e250d4f95b44c3bc0e6">GrossAssim</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordtype">double</span> IDiff = light_profile.<a class="code" href="structLight__profile.html#a3a64c8a4ce00e9190ec3f3b8b7233817">diffuse_irradiance</a>[current_layer];  <span class="comment">// micromole / m^2 /s</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordtype">double</span> pLeafshade = light_profile.<a class="code" href="structLight__profile.html#a61e74afb9cc127be0696334b9a1ffdc8">shaded_fraction</a>[current_layer];  <span class="comment">// dimensionless</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordtype">double</span> Leafshade = LAIc * pLeafshade;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordtype">double</span> stomatal_conductance_diffuse = <a class="code" href="c3photo_8cpp.html#a4889758656320bc9290988b4dd5dcec2">c3photoC</a>(IDiff, air_temperature, relative_humidity, vmax1, Jmax, Rd, b0, b1, Catm, o2, theta, StomataWS, water_stress_approach, electrons_per_carboxylation, electrons_per_oxygenation).<a class="code" href="structc3__str.html#a2fcc3787ac1ca5dd5be990fc00fb92f6">Gs</a>;  <span class="comment">// mmol / m^2 / s. Estimate stomatal_conductance by assuming the leaf has the same temperature as the air.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keyword">struct </span><a class="code" href="structET__Str.html">ET_Str</a> et_diffuse = <a class="code" href="BioCro_8h.html#a6fa022454f0de8f427c38ad0cbec1314">c3EvapoTrans</a>(Itot, air_temperature, relative_humidity, layer_wind_speed, CanHeight, stomatal_conductance_diffuse);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordtype">double</span> leaf_temperature_Idiffuse = air_temperature + et_diffuse.<a class="code" href="structET__Str.html#af1313b200fdfaf71c6d4ee070ddeaf8c">Deltat</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        temp_photo_results = <a class="code" href="c3photo_8cpp.html#a4889758656320bc9290988b4dd5dcec2">c3photoC</a>(IDiff, leaf_temperature_Idiffuse, relative_humidity, vmax1, Jmax, Rd, b0, b1, Catm, o2, theta, StomataWS, water_stress_approach, electrons_per_carboxylation, electrons_per_oxygenation);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordtype">double</span> AssIdiff = temp_photo_results.<a class="code" href="structc3__str.html#a859d76f4c4e8c6a96e34e9b99f2857dc">Assim</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordtype">double</span> GAssIdiff = temp_photo_results.<a class="code" href="structc3__str.html#a0d2c3391dcf87e250d4f95b44c3bc0e6">GrossAssim</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        CanopyA += Leafsun * AssIdir + Leafshade * AssIdiff;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        GCanopyA += Leafsun * GAssIdir + Leafshade * GAssIdiff;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        CanopyT += Leafsun * et_direct.<a class="code" href="structET__Str.html#a6459f6ef779feb02861948dc4f4b06f0">TransR</a> + Leafshade * et_diffuse.<a class="code" href="structET__Str.html#a6459f6ef779feb02861948dc4f4b06f0">TransR</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <span class="comment">/* CanopyA has units of micromole CO2 / m^2 / s.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">    * 3600 s / hr</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">    * 10^-6 mol / micromole</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">    * 30 g / mol - grams of C6H12O6 (glucose) incorporated into dry biomass per mole of CO2</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">    * 10^-6 Mg / g</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">    * 10000 m^2 / ha</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 3600 * 1e-6 * 30 * 1e-6 * 10000;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   <span class="comment">/* CanopyT has units of mmol H2O / m^2 / s.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">    * 3600 s / hr</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">    * 10^-3 mol / mmol</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">    * 18 g / (mol H2O)</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">    * 10^-6 Mg / g</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">    * 10000 m^2 / ha</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> cf2 = 3600 * 1e-3 * 18 * 1e-6 * 10000; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keyword">struct </span><a class="code" href="structCan__Str.html">Can_Str</a> ans;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    ans.<a class="code" href="structCan__Str.html#af806a0ccf68200e30014c08ed1a903ed">Assim</a> = cf * CanopyA * (1.0 - growth_respiration_fraction);  <span class="comment">// Mg / ha / hr.</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    ans.Trans = cf2 * CanopyT;   <span class="comment">// Mg / ha / hr.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    ans.GrossAssim = cf * GCanopyA;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="c3photo_8hpp_source.html#l00009">c3_str::Assim</a>, <a class="el" href="AuxBioCro_8h_source.html#l00046">Can_Str::Assim</a>, <a class="el" href="c3EvapoTrans_8cpp_source.html#l00018">c3EvapoTrans()</a>, <a class="el" href="c3photo_8cpp_source.html#l00027">c3photoC()</a>, <a class="el" href="BioCro_8h_source.html#l00012">Light_model::cosine_zenith_angle</a>, <a class="el" href="AuxBioCro_8h_source.html#l00042">ET_Str::Deltat</a>, <a class="el" href="AuxBioCro_8h_source.html#l00031">Light_profile::diffuse_irradiance</a>, <a class="el" href="BioCro_8h_source.html#l00011">Light_model::diffuse_irradiance_fraction</a>, <a class="el" href="AuxBioCro_8h_source.html#l00029">Light_profile::direct_irradiance</a>, <a class="el" href="BioCro_8h_source.html#l00010">Light_model::direct_irradiance_fraction</a>, <a class="el" href="c3photo_8hpp_source.html#l00012">c3_str::GrossAssim</a>, <a class="el" href="AuxBioCro_8h_source.html#l00048">Can_Str::GrossAssim</a>, <a class="el" href="c3photo_8hpp_source.html#l00010">c3_str::Gs</a>, <a class="el" href="AuxBioCro_8h_source.html#l00035">Light_profile::height</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00095">lightME()</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00274">LNprof()</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00255">RHprof()</a>, <a class="el" href="AuxBioCro_8h_source.html#l00034">Light_profile::shaded_fraction</a>, <a class="el" href="AuxBioCro_8h_source.html#l00033">Light_profile::sunlit_fraction</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00149">sunML()</a>, <a class="el" href="AuxBioCro_8h_source.html#l00032">Light_profile::total_irradiance</a>, <a class="el" href="AuxBioCro_8h_source.html#l00047">Can_Str::Trans</a>, <a class="el" href="AuxBioCro_8h_source.html#l00039">ET_Str::TransR</a>, and <a class="el" href="AuxBioCro_8cpp_source.html#l00233">WINDprof()</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="BioCro_8h_a542c69a99fb2b34f3be5a4d596de5f3a_cgraph.png" border="0" usemap="#BioCro_8h_a542c69a99fb2b34f3be5a4d596de5f3a_cgraph" alt=""/></div>
<map name="BioCro_8h_a542c69a99fb2b34f3be5a4d596de5f3a_cgraph" id="BioCro_8h_a542c69a99fb2b34f3be5a4d596de5f3a_cgraph">
<area shape="rect" title=" " alt="" coords="5,259,83,285"/>
<area shape="rect" href="BioCro_8h.html#a6fa022454f0de8f427c38ad0cbec1314" title=" " alt="" coords="131,107,236,133"/>
<area shape="rect" href="c3photo_8cpp.html#a4889758656320bc9290988b4dd5dcec2" title=" " alt="" coords="145,157,222,184"/>
<area shape="rect" href="AuxBioCro_8cpp.html#ac5f31df2b025300918f031bf8f1e51d9" title=" " alt="" coords="151,208,216,235"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a2905c23b422ad454d9577841ca594d0d" title=" " alt="" coords="152,259,215,285"/>
<area shape="rect" href="AuxBioCro_8cpp.html#aa4d2cdd07093428af4830f4c8afd660c" title=" " alt="" coords="152,309,215,336"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a29eacaa214f1899c9df199ac80d0e1ca" title=" " alt="" coords="152,360,215,387"/>
<area shape="rect" href="AuxBioCro_8cpp.html#ad5f0fc680176f312e47c32701ce779f7" title=" " alt="" coords="144,411,223,437"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a117fba2c85ba6d52345e7cefc05a43ff" title=" " alt="" coords="284,5,459,32"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a6380d8cd4192408df76baefe6b369a70" title=" " alt="" coords="319,56,424,83"/>
<area shape="rect" href="AuxBioCro_8cpp.html#ae810651283c6640ef4669d0eede1c942" title=" " alt="" coords="323,107,420,133"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a05f381bbff6170709a8d0e2e34f4556a" title=" " alt="" coords="323,157,419,184"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a81eccf5a903a575f17d799d959397f61" title=" " alt="" coords="310,208,433,235"/>
</map>
</div>

</div>
</div>
<a id="a6fa022454f0de8f427c38ad0cbec1314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fa022454f0de8f427c38ad0cbec1314">&#9670;&nbsp;</a></span>c3EvapoTrans()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structET__Str.html">ET_Str</a> c3EvapoTrans </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Itot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Airtemperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CanopyHeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stomtal_conductance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="c3EvapoTrans_8cpp_source.html#l00001">1</a> of file <a class="el" href="c3EvapoTrans_8cpp_source.html">c3EvapoTrans.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    constexpr <span class="keywordtype">double</span> StefanBoltzmann = 5.67037e-8;       <span class="comment">// J / m^2 / s^1 / K^4</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    constexpr <span class="keywordtype">double</span> tau = 0.2;                          <span class="comment">// dimensionless. Leaf transmission coefficient.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    constexpr <span class="keywordtype">double</span> LeafReflectance = 0.2;              <span class="comment">// dimensionless</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    constexpr <span class="keywordtype">double</span> SpecificHeat = 1010;                <span class="comment">// J / kg / K</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    constexpr <span class="keywordtype">double</span> kappa = 0.41;                       <span class="comment">// dimensionless. von Karmon&#39;s constant. Thornley and Johnson pgs 414 and 416.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    constexpr <span class="keywordtype">double</span> WindSpeedHeight = 5;                <span class="comment">// meters</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    constexpr <span class="keywordtype">double</span> dCoef = 0.77;                       <span class="comment">// dimensionless</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    constexpr <span class="keywordtype">double</span> ZetaCoef = 0.026;                   <span class="comment">// dimensionless</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    constexpr <span class="keywordtype">double</span> ZetaMCoef = 0.13;                   <span class="comment">// dimensionless</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Zeta = ZetaCoef * CanopyHeight;         <span class="comment">// meters</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Zetam = ZetaMCoef * CanopyHeight;       <span class="comment">// meters</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> d = dCoef * CanopyHeight;               <span class="comment">// meters</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    constexpr <span class="keywordtype">double</span> molar_mass_of_water = 18.01528e-3;  <span class="comment">// kg / mol</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    constexpr <span class="keywordtype">double</span> R = 8.314472;                       <span class="comment">// joule / kelvin / mole.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">//constexpr double atmospheric_pressure = 101325;      // Pa</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    constexpr <span class="keywordtype">double</span> joules_per_micromole_PAR = 0.235;   <span class="comment">// J / micromole. For the wavelengths that make up PAR in sunlight, one mole of photons has, on average, approximately 2.35 x 10^5 joules:</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> (CanopyHeight &lt; 0.1)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        CanopyHeight = 0.1;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> DdryA = <a class="code" href="AuxBioCro_8cpp.html#a6380d8cd4192408df76baefe6b369a70">TempToDdryA</a>(air_temperature);  <span class="comment">// kg / m^3</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> LHV = <a class="code" href="AuxBioCro_8cpp.html#ae810651283c6640ef4669d0eede1c942">TempToLHV</a>(air_temperature);  <span class="comment">// J / kg</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> SlopeFS = <a class="code" href="AuxBioCro_8cpp.html#a05f381bbff6170709a8d0e2e34f4556a">TempToSFS</a>(air_temperature);  <span class="comment">// kg / m^3 / K. It is also kg / m^3 / degrees C since it&#39;s a change in temperature.</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> SWVP = <a class="code" href="AuxBioCro_8cpp.html#a117fba2c85ba6d52345e7cefc05a43ff">saturation_vapor_pressure</a>(air_temperature);  <span class="comment">// Pa</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    constexpr <span class="keywordtype">double</span> volume_of_one_mole_of_air = 24.39e-3;  <span class="comment">// m^3 / mol. TODO: This is for about 20 degrees C at 100000 Pa. Change it to use the model state. (1 * R * temperature) / pressure</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">double</span> conductance_in_m_per_s = stomatal_conductance * 1e-3 * volume_of_one_mole_of_air;  <span class="comment">// m / s</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">if</span> (conductance_in_m_per_s &lt;= 0) <span class="comment">/* Prevent errors due to extremely low Layer conductance. */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        conductance_in_m_per_s = 0.01;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> (RH &gt; 1)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">throw</span> std::range_error(<span class="stringliteral">&quot;Thrown in c3EvapoTrans: RH (relative humidity) is greater than 1.&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">/* SOLAR RADIATION COMPONENT*/</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> totalradiation = Itot * joules_per_micromole_PAR;  <span class="comment">// W / m^2.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> SWVC = SWVP / R / (air_temperature + 273.15) * molar_mass_of_water;  <span class="comment">// kg / m^3. Convert from vapor pressure to vapor density using the ideal gas law. This is approximately right for temperatures what won&#39;t kill plants.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (SWVC &lt; 0)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">throw</span> std::range_error(<span class="stringliteral">&quot;Thrown in c3EvapoTrans: SWVC is less than 0.&quot;</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> PsycParam = DdryA * SpecificHeat / LHV;  <span class="comment">// kg / m^3 / K</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> DeltaPVa = SWVC * (1 - RH);  <span class="comment">// kg / m^3</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Ja = 2 * totalradiation * (1 - LeafReflectance - tau) / (1 - tau);  <span class="comment">// W / m^2</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">/* AERODYNAMIC COMPONENT */</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">if</span> (WindSpeed &lt; 0.5) WindSpeed = 0.5;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">/* Calculation of ga */</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">/* According to thornley and Johnson pg. 416 */</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> ga0 = pow(kappa, 2) * WindSpeed;                     <span class="comment">// m / s</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> ga1 = log((WindSpeedHeight + Zeta - d) / Zeta);      <span class="comment">// dimensionless</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> ga2 = log((WindSpeedHeight + Zetam - d) / Zetam);    <span class="comment">// dimensionless</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> ga = ga0 / (ga1 * ga2);                              <span class="comment">// m / s</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span> (ga &lt; 0)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">throw</span> std::range_error(<span class="stringliteral">&quot;Thrown in c3EvapoTrans: ga is less than zero.&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">/* Temperature of the leaf according to Campbell and Norman (1998) Chp 4.*/</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">/* This version is non-iterative and an approximation*/</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">/* Stefan-Boltzmann law: B = sigma * T^4. where sigma is the Boltzmann constant: 5.67 * 1e-8 W m^-2 K^-4. */</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">/* From Table A.3 in Campbell and Norman.*/</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">/* This is the original from WIMOVAC*/</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">double</span> Deltat = 0.01;  <span class="comment">// degrees C</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;Evapotrans inputs: &quot; &lt;&lt; Itot &lt;&lt; &quot;, &quot; &lt;&lt; air_temperature &lt;&lt; &quot;, &quot; &lt;&lt; RH &lt;&lt; &quot;, &quot; &lt;&lt; WindSpeed &lt;&lt; &quot;, &quot; &lt;&lt; CanopyHeight &lt;&lt; &quot;, &quot; &lt;&lt; stomatal_conductance &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;Delta t in c3EvapoTrans, initial: &quot; &lt;&lt; Deltat &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">double</span> PhiN;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordtype">double</span> ChangeInLeafTemp = 10;  <span class="comment">// degrees C</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> Counter = 0; (ChangeInLeafTemp &gt; 0.5) &amp;&amp; (Counter &lt;= 10); ++Counter) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordtype">double</span> OldDeltaT = Deltat;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordtype">double</span> rlc = 4.0 * StefanBoltzmann * pow(273.0 + air_temperature, 3.0) * Deltat;  <span class="comment">// W / m^2</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            PhiN = Ja - rlc;  <span class="comment">// W / m^2</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordtype">double</span> TopValue = PhiN * (1 / ga + 1 / conductance_in_m_per_s) - LHV * DeltaPVa;  <span class="comment">// J / m^3</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keywordtype">double</span> BottomValue = LHV * (SlopeFS + PsycParam * (1 + ga / conductance_in_m_per_s));  <span class="comment">// J / m^2 / K</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            Deltat = TopValue / BottomValue;  <span class="comment">// kelvin. It is also degrees C, because it is a temperature difference.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            Deltat = std::min(std::max(Deltat, -5.0), 5.0);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            ChangeInLeafTemp = fabs(OldDeltaT - Deltat);  <span class="comment">// kelvin. It is also degrees C, because it is a temperature difference.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;Delta t in c3EvapoTrans, final: &quot; &lt;&lt; Deltat &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> (PhiN &lt; 0)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        PhiN = 0;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> TransR = (SlopeFS * PhiN + LHV * PsycParam * ga * DeltaPVa)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        / (LHV * (SlopeFS + PsycParam * (1 + ga / conductance_in_m_per_s)));  <span class="comment">// kg / m^2 / s</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> EPen = (SlopeFS * PhiN + LHV * PsycParam * ga * DeltaPVa)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        / (LHV * (SlopeFS + PsycParam));  <span class="comment">// kg / m^2 / s</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> EPries = 1.26 * (SlopeFS * PhiN / (LHV * (SlopeFS + PsycParam)));  <span class="comment">// kg / m^2 / s</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// TransR has units of kg / m^2 / s.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// Convert to mm / m^2 / s.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">/* 1e3 - g / kg  */</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">/* 18 - g / mol for water */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">/* 1e3 - mmol / mol */</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keyword">struct </span><a class="code" href="structET__Str.html">ET_Str</a> et_results;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    et_results.<a class="code" href="structET__Str.html#a6459f6ef779feb02861948dc4f4b06f0">TransR</a> = <a class="code" href="structET__Str.html#a6459f6ef779feb02861948dc4f4b06f0">TransR</a> * 1e3 * 1e3 / 18;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    et_results.EPenman = EPen * 1e3 * 1e3 / 18;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    et_results.EPriestly = EPries * 1e3 * 1e3 / 18;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    et_results.Deltat = <a class="code" href="structET__Str.html#af1313b200fdfaf71c6d4ee070ddeaf8c">Deltat</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">return</span> et_results;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="AuxBioCro_8h_source.html#l00042">ET_Str::Deltat</a>, <a class="el" href="AuxBioCro_8h_source.html#l00040">ET_Str::EPenman</a>, <a class="el" href="AuxBioCro_8h_source.html#l00041">ET_Str::EPriestly</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00325">saturation_vapor_pressure()</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00284">TempToDdryA()</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00301">TempToLHV()</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00319">TempToSFS()</a>, and <a class="el" href="AuxBioCro_8h_source.html#l00039">ET_Str::TransR</a>.</p>

<p class="reference">Referenced by <a class="el" href="c3CanAC_8cpp_source.html#l00004">c3CanAC()</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="BioCro_8h_a6fa022454f0de8f427c38ad0cbec1314_cgraph.png" border="0" usemap="#BioCro_8h_a6fa022454f0de8f427c38ad0cbec1314_cgraph" alt=""/></div>
<map name="BioCro_8h_a6fa022454f0de8f427c38ad0cbec1314_cgraph" id="BioCro_8h_a6fa022454f0de8f427c38ad0cbec1314_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,111,108"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a117fba2c85ba6d52345e7cefc05a43ff" title=" " alt="" coords="159,5,333,32"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a6380d8cd4192408df76baefe6b369a70" title=" " alt="" coords="193,56,299,83"/>
<area shape="rect" href="AuxBioCro_8cpp.html#ae810651283c6640ef4669d0eede1c942" title=" " alt="" coords="197,107,295,133"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a05f381bbff6170709a8d0e2e34f4556a" title=" " alt="" coords="198,157,294,184"/>
</map>
</div>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="BioCro_8h_a6fa022454f0de8f427c38ad0cbec1314_icgraph.png" border="0" usemap="#BioCro_8h_a6fa022454f0de8f427c38ad0cbec1314_icgraph" alt=""/></div>
<map name="BioCro_8h_a6fa022454f0de8f427c38ad0cbec1314_icgraph" id="BioCro_8h_a6fa022454f0de8f427c38ad0cbec1314_icgraph">
<area shape="rect" title=" " alt="" coords="131,5,236,32"/>
<area shape="rect" href="c3CanAC_8cpp.html#abe33cbe09472254ce42dc5ff9f397dd1" title=" " alt="" coords="5,5,83,32"/>
</map>
</div>

</div>
</div>
<a id="a799eb2bb22fdef53d633f44a4c0ef1b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a799eb2bb22fdef53d633f44a4c0ef1b9">&#9670;&nbsp;</a></span>CanAC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structCan__Str.html">Can_Str</a> CanAC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kparm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>upperT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lowerT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structnitroParms.html">nitroParms</a> &amp;&#160;</td>
          <td class="paramname"><em>nitroP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafwidth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eteq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomataWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>water_stress_approach</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CanAC_8cpp_source.html#l00001">1</a> of file <a class="el" href="CanAC_8cpp_source.html">CanAC.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keyword">struct </span><a class="code" href="structLight__model.html">Light_model</a> light_model = <a class="code" href="AuxBioCro_8cpp.html#ac5f31df2b025300918f031bf8f1e51d9">lightME</a>(lat, DOY, hr);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">double</span> Idir = light_model.<a class="code" href="structLight__model.html#a29f813f0ce340f3d02748daffbec5200">direct_irradiance_fraction</a> * solarR;  <span class="comment">// micromole / m^2 / s. Flux through a plane perpendicular to the rays of the sun.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">double</span> Idiff = light_model.<a class="code" href="structLight__model.html#a5ecfb901306b14488b8b3e2e851f63b6">diffuse_irradiance_fraction</a> * solarR;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">double</span> cosTh = light_model.<a class="code" href="structLight__model.html#a8ad7918d4aada10f0c64e073da9c4ff4">cosine_zenith_angle</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">struct </span><a class="code" href="structLight__profile.html">Light_profile</a> light_profile = <a class="code" href="AuxBioCro_8cpp.html#a29eacaa214f1899c9df199ac80d0e1ca">sunML</a>(Idir, Idiff, LAI, nlayers, cosTh, kd, chil, heightf);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">double</span> LAIc = LAI / nlayers;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">double</span> relative_humidity_profile[nlayers];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="AuxBioCro_8cpp.html#aa4d2cdd07093428af4830f4c8afd660c">RHprof</a>(RH, nlayers, relative_humidity_profile);  <span class="comment">// Modifies relative_humidity_profile.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">double</span> wind_speed_profile[nlayers];</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="AuxBioCro_8cpp.html#ad5f0fc680176f312e47c32701ce779f7">WINDprof</a>(WindSpeed, LAI, nlayers, wind_speed_profile);  <span class="comment">// Modifies wind_speed_profile.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">double</span> leafN_profile[nlayers];</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="AuxBioCro_8cpp.html#a2905c23b422ad454d9577841ca594d0d">LNprof</a>(leafN, LAI, nlayers, kpLN, leafN_profile);  <span class="comment">// Modifies leafN_profile.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">double</span> CanopyA = 0.0, GCanopyA = 0.0, CanopyT = 0.0, CanopyPe = 0.0, CanopyPr = 0.0;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">double</span> canopy_conductance = 0.0;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">double</span> result_matrix[21 * <a class="code" href="AuxBioCro_8h.html#a57179778cb6aed95fb9f484b55873d6f">MAXLAY</a>];</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nlayers; ++i)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordtype">int</span> current_layer = nlayers - 1 - i;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordtype">double</span> leafN_lay = leafN_profile[current_layer];</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordtype">double</span> vmax1;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">if</span> (lnfun == 0) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            vmax1 = Vmax;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            vmax1 = nitroP.<a class="code" href="structnitroParms.html#a1c7f001a6620cba218a735e94dacafc5">Vmaxb1</a> * leafN_lay + nitroP.<a class="code" href="structnitroParms.html#af39da18e7964fdbe77fde342dcf97a5b">Vmaxb0</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordflow">if</span> (vmax1 &lt; 0) vmax1 = 0.0;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordflow">if</span> (vmax1 &gt; Vmax) vmax1 = Vmax;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            Alpha = nitroP.<a class="code" href="structnitroParms.html#ab996844d0d28b9ed8324652ef03c7a9f">alphab1</a> * leafN_lay + nitroP.<a class="code" href="structnitroParms.html#a6ec6c8e941790e6cffb91bcc9916df67">alphab0</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            Rd = nitroP.<a class="code" href="structnitroParms.html#aafdfebf8e92977c0185a1e4a3155b439">Rdb1</a> * leafN_lay + nitroP.<a class="code" href="structnitroParms.html#ab87cf4969607b3d3afd0bd895b219543">Rdb0</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordtype">double</span> relative_humidity = relative_humidity_profile[current_layer];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordtype">double</span> layer_wind_speed = wind_speed_profile[current_layer];</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordtype">double</span> CanHeight = light_profile.<a class="code" href="structLight__profile.html#ab9551f243ec3ef975ebb13d1566aa75a">height</a>[current_layer];  <span class="comment">// meters</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordtype">double</span> Itot = light_profile.<a class="code" href="structLight__profile.html#a424cf9cc81031798184256d14a08786a">total_irradiance</a>[current_layer];  <span class="comment">// micromole / m^2 / s</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordtype">double</span> IDir = light_profile.<a class="code" href="structLight__profile.html#a2f8231e1e3f6b0c04e8a08ddcc419e03">direct_irradiance</a>[current_layer];  <span class="comment">// micromole / m^2 / s</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordtype">double</span> pLeafsun = light_profile.<a class="code" href="structLight__profile.html#a5ab1c660a6d5af30163325103043a419">sunlit_fraction</a>[current_layer];  <span class="comment">// dimensionless. Fraction of LAI that is sunlit.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordtype">double</span> Leafsun = LAIc * pLeafsun;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordtype">double</span> direct_stomatal_conductance = <a class="code" href="c4photo_8cpp.html#a267a416bf303e187cbab12efcad0227a">c4photoC</a>(IDir, temperature, relative_humidity, vmax1, Alpha, Kparm, theta, beta, Rd, b0, b1, StomataWS, Catm, water_stress_approach, upperT, lowerT).<a class="code" href="structc4__str.html#a29de44c5705baf89ff902918ed0eebee">Gs</a>; <span class="comment">// mmol / m^2 / s</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keyword">struct </span><a class="code" href="structET__Str.html">ET_Str</a> et_direct = <a class="code" href="AuxBioCro_8cpp.html#a5272d35a20edaa0de28ca4ccae5b10a5">EvapoTrans2</a>(IDir, Itot, temperature, relative_humidity, layer_wind_speed, LAIc, CanHeight, direct_stomatal_conductance, leafwidth, eteq);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordtype">double</span> leaf_temperature_Idir = temperature + et_direct.<a class="code" href="structET__Str.html#af1313b200fdfaf71c6d4ee070ddeaf8c">Deltat</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> direct_photo = <a class="code" href="c4photo_8cpp.html#a267a416bf303e187cbab12efcad0227a">c4photoC</a>(IDir, leaf_temperature_Idir, relative_humidity, vmax1, Alpha, Kparm, theta, beta, Rd, b0, b1, StomataWS, Catm, water_stress_approach, upperT, lowerT);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordtype">double</span> IDiff = light_profile.<a class="code" href="structLight__profile.html#a3a64c8a4ce00e9190ec3f3b8b7233817">diffuse_irradiance</a>[current_layer];  <span class="comment">// micromole / m^2 / s</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordtype">double</span> pLeafshade = light_profile.<a class="code" href="structLight__profile.html#a61e74afb9cc127be0696334b9a1ffdc8">shaded_fraction</a>[current_layer];  <span class="comment">// dimensionless. Fraction of LAI that is shaded.</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordtype">double</span> Leafshade = LAIc * pLeafshade;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="comment">//Rprintf(&quot;current_layer,CumLAI,leafN_lay,relative_humidity,layer_wind_speed,CanHeight,Itot,IDir,pLeafSun,IDiff,pLeafShade\n&quot;);</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="comment">//Rprintf(&quot;%i,%f,%f,%f,%f,%f,%f,%f,%f,%f,%f\n&quot;, current_layer, LAIc * (current_layer + 0.5), leafN_lay, relative_humidity, layer_wind_speed, CanHeight, Itot, IDir, pLeafsun, IDiff, pLeafshade);</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordtype">double</span> diffuse_stomatal_conductance = <a class="code" href="c4photo_8cpp.html#a267a416bf303e187cbab12efcad0227a">c4photoC</a>(IDiff, temperature, relative_humidity, vmax1, Alpha, Kparm, theta, beta, Rd, b0, b1, StomataWS, Catm, water_stress_approach, upperT, lowerT).<a class="code" href="structc4__str.html#a29de44c5705baf89ff902918ed0eebee">Gs</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keyword">struct </span><a class="code" href="structET__Str.html">ET_Str</a> et_diffuse = <a class="code" href="AuxBioCro_8cpp.html#a5272d35a20edaa0de28ca4ccae5b10a5">EvapoTrans2</a>(IDiff, Itot, temperature, relative_humidity, layer_wind_speed, LAIc, CanHeight, diffuse_stomatal_conductance, leafwidth, eteq);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordtype">double</span> leaf_temp_Idiffuse = temperature + et_diffuse.<a class="code" href="structET__Str.html#af1313b200fdfaf71c6d4ee070ddeaf8c">Deltat</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> diffuse_photo = <a class="code" href="c4photo_8cpp.html#a267a416bf303e187cbab12efcad0227a">c4photoC</a>(IDiff, leaf_temp_Idiffuse, relative_humidity, vmax1, Alpha, Kparm, theta, beta, Rd, b0, b1, StomataWS, Catm, water_stress_approach, upperT, lowerT);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        CanopyA += Leafsun * direct_photo.<a class="code" href="structc4__str.html#ade490c8a63b9554b0ee7d88ee7f8153b">Assim</a> + Leafshade * diffuse_photo.<a class="code" href="structc4__str.html#ade490c8a63b9554b0ee7d88ee7f8153b">Assim</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        CanopyT += Leafsun * et_direct.<a class="code" href="structET__Str.html#a6459f6ef779feb02861948dc4f4b06f0">TransR</a> + Leafshade * et_diffuse.<a class="code" href="structET__Str.html#a6459f6ef779feb02861948dc4f4b06f0">TransR</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        GCanopyA += Leafsun * direct_photo.<a class="code" href="structc4__str.html#a928a57132388ea027d82a5d841d29ea3">GrossAssim</a> + Leafshade * diffuse_photo.<a class="code" href="structc4__str.html#a928a57132388ea027d82a5d841d29ea3">GrossAssim</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">//Rprintf(&quot;shade leaf assim %f; sun leaf assim %f; shade trans %f; sun trans %f\n&quot;, diffuse_photo.Assim, direct_photo.Assim, et_diffuse.TransR, et_direct.TransR);</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        CanopyPe += Leafsun * et_direct.<a class="code" href="structET__Str.html#a6407d50c376c4982344370729ecb5e95">EPenman</a> + Leafshade * et_diffuse.<a class="code" href="structET__Str.html#a6407d50c376c4982344370729ecb5e95">EPenman</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        CanopyPr += Leafsun * et_direct.<a class="code" href="structET__Str.html#aa5c251e199215e0ab35a58a8e2a34a32">EPriestly</a> + Leafshade * et_diffuse.<a class="code" href="structET__Str.html#aa5c251e199215e0ab35a58a8e2a34a32">EPriestly</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        canopy_conductance += Leafsun * direct_photo.<a class="code" href="structc4__str.html#a29de44c5705baf89ff902918ed0eebee">Gs</a> + Leafshade * diffuse_photo.<a class="code" href="structc4__str.html#a29de44c5705baf89ff902918ed0eebee">Gs</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        result_matrix[    i*21] = IDir;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        result_matrix[1 + i*21] = IDiff;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        result_matrix[2 + i*21] = Leafsun;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        result_matrix[3 + i*21] = Leafshade;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        result_matrix[4 + i*21] = et_direct.<a class="code" href="structET__Str.html#a6459f6ef779feb02861948dc4f4b06f0">TransR</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        result_matrix[5 + i*21] = et_diffuse.<a class="code" href="structET__Str.html#a6459f6ef779feb02861948dc4f4b06f0">TransR</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        result_matrix[6 + i*21] = direct_photo.<a class="code" href="structc4__str.html#ade490c8a63b9554b0ee7d88ee7f8153b">Assim</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        result_matrix[7 + i*21] = diffuse_photo.<a class="code" href="structc4__str.html#ade490c8a63b9554b0ee7d88ee7f8153b">Assim</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        result_matrix[8 + i*21] = et_direct.<a class="code" href="structET__Str.html#af1313b200fdfaf71c6d4ee070ddeaf8c">Deltat</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        result_matrix[9 + i*21] = et_diffuse.<a class="code" href="structET__Str.html#af1313b200fdfaf71c6d4ee070ddeaf8c">Deltat</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        result_matrix[10 + i*21] = direct_photo.<a class="code" href="structc4__str.html#a29de44c5705baf89ff902918ed0eebee">Gs</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        result_matrix[11 + i*21] = diffuse_photo.<a class="code" href="structc4__str.html#a29de44c5705baf89ff902918ed0eebee">Gs</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        result_matrix[12 + i*21] = leafN_lay;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        result_matrix[13 + i*21] = vmax1;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        result_matrix[14 + i*21] = relative_humidity;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        result_matrix[15 + i*21] = direct_photo.<a class="code" href="structc4__str.html#a928a57132388ea027d82a5d841d29ea3">GrossAssim</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        result_matrix[16 + i*21] = diffuse_photo.<a class="code" href="structc4__str.html#a928a57132388ea027d82a5d841d29ea3">GrossAssim</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        result_matrix[17 + i*21] = Alpha;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        result_matrix[18 + i*21] = leafN_lay;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        result_matrix[19 + i*21] = layer_wind_speed;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        result_matrix[20 + i*21] = CanHeight;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keyword">struct </span><a class="code" href="structCan__Str.html">Can_Str</a> ans;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">/* For Assimilation */</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">/* 3600 - seconds per hour */</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">/* 1e-6 - moles per micromole */</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">/* 30 - grams of C6H12O6 (glucose) incorporated into dry biomass per mole of CO2 */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">/* 1e-6 - megagrams per gram */</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">/* 10000 - meters squared per hectare*/</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    ans.<a class="code" href="structCan__Str.html#af806a0ccf68200e30014c08ed1a903ed">Assim</a> = CanopyA * 3600 * 1e-6 * 30 * 1e-6 * 10000;  <span class="comment">// Mg / ha / hr.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    ans.GrossAssim = GCanopyA * 3600 * 1e-6 * 30 * 1e-6 * 10000;  <span class="comment">// Mg / ha / hr.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">/* For Transpiration */</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">/* 3600 - seconds per hour */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">/* 1e-3 - millimoles per mole */</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">/* 18 - grams per mole for H2O */</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">/* 1e-6 - megagrams per  gram */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">/* 10000 - meters squared per hectare */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    ans.Trans = CanopyT * 3600 * 1e-3 * 18 * 1e-6 * 10000;  <span class="comment">// Mg / ha / hr.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    ans.canopy_transpiration_penman = CanopyPe;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    ans.canopy_transpiration_priestly = CanopyPr;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    ans.canopy_conductance = <a class="code" href="structCan__Str.html#a3e32f6d12a6771e23ff40eff5796e26f">canopy_conductance</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nlayers * 21; ++i) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        ans.result_matrix[i] = <a class="code" href="structCan__Str.html#a652f573fcd65d47a2690915af8966af4">result_matrix</a>[i];</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="c4photo_8h_source.html#l00009">c4_str::Assim</a>, <a class="el" href="AuxBioCro_8h_source.html#l00046">Can_Str::Assim</a>, <a class="el" href="c4photo_8cpp_source.html#l00015">c4photoC()</a>, <a class="el" href="AuxBioCro_8h_source.html#l00052">Can_Str::canopy_conductance</a>, <a class="el" href="AuxBioCro_8h_source.html#l00050">Can_Str::canopy_transpiration_penman</a>, <a class="el" href="AuxBioCro_8h_source.html#l00051">Can_Str::canopy_transpiration_priestly</a>, <a class="el" href="BioCro_8h_source.html#l00012">Light_model::cosine_zenith_angle</a>, <a class="el" href="AuxBioCro_8h_source.html#l00042">ET_Str::Deltat</a>, <a class="el" href="AuxBioCro_8h_source.html#l00031">Light_profile::diffuse_irradiance</a>, <a class="el" href="BioCro_8h_source.html#l00011">Light_model::diffuse_irradiance_fraction</a>, <a class="el" href="AuxBioCro_8h_source.html#l00029">Light_profile::direct_irradiance</a>, <a class="el" href="BioCro_8h_source.html#l00010">Light_model::direct_irradiance_fraction</a>, <a class="el" href="AuxBioCro_8h_source.html#l00040">ET_Str::EPenman</a>, <a class="el" href="AuxBioCro_8h_source.html#l00041">ET_Str::EPriestly</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00335">EvapoTrans2()</a>, <a class="el" href="c4photo_8h_source.html#l00012">c4_str::GrossAssim</a>, <a class="el" href="AuxBioCro_8h_source.html#l00048">Can_Str::GrossAssim</a>, <a class="el" href="c4photo_8h_source.html#l00010">c4_str::Gs</a>, <a class="el" href="AuxBioCro_8h_source.html#l00035">Light_profile::height</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00095">lightME()</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00274">LNprof()</a>, <a class="el" href="AuxBioCro_8h_source.html#l00017">MAXLAY</a>, <a class="el" href="AuxBioCro_8h_source.html#l00049">Can_Str::result_matrix</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00255">RHprof()</a>, <a class="el" href="AuxBioCro_8h_source.html#l00034">Light_profile::shaded_fraction</a>, <a class="el" href="AuxBioCro_8h_source.html#l00033">Light_profile::sunlit_fraction</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00149">sunML()</a>, <a class="el" href="AuxBioCro_8h_source.html#l00032">Light_profile::total_irradiance</a>, <a class="el" href="AuxBioCro_8h_source.html#l00047">Can_Str::Trans</a>, <a class="el" href="AuxBioCro_8h_source.html#l00039">ET_Str::TransR</a>, and <a class="el" href="AuxBioCro_8cpp_source.html#l00233">WINDprof()</a>.</p>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="BioCro_8h_a799eb2bb22fdef53d633f44a4c0ef1b9_cgraph.png" border="0" usemap="#BioCro_8h_a799eb2bb22fdef53d633f44a4c0ef1b9_cgraph" alt=""/></div>
<map name="BioCro_8h_a799eb2bb22fdef53d633f44a4c0ef1b9_cgraph" id="BioCro_8h_a799eb2bb22fdef53d633f44a4c0ef1b9_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,68,184"/>
<area shape="rect" href="c4photo_8cpp.html#a267a416bf303e187cbab12efcad0227a" title=" " alt="" coords="127,5,204,32"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a5272d35a20edaa0de28ca4ccae5b10a5" title=" " alt="" coords="116,56,215,83"/>
<area shape="rect" href="AuxBioCro_8cpp.html#ac5f31df2b025300918f031bf8f1e51d9" title=" " alt="" coords="133,107,198,133"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a2905c23b422ad454d9577841ca594d0d" title=" " alt="" coords="134,157,197,184"/>
<area shape="rect" href="AuxBioCro_8cpp.html#aa4d2cdd07093428af4830f4c8afd660c" title=" " alt="" coords="134,208,197,235"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a29eacaa214f1899c9df199ac80d0e1ca" title=" " alt="" coords="134,259,197,285"/>
<area shape="rect" href="AuxBioCro_8cpp.html#ad5f0fc680176f312e47c32701ce779f7" title=" " alt="" coords="126,309,205,336"/>
<area shape="rect" href="ball__berry_8cpp.html#a6e9346e63ae6f11483c7104df9ecf92c" title=" " alt="" coords="285,5,363,32"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a81eccf5a903a575f17d799d959397f61" title=" " alt="" coords="263,107,385,133"/>
</map>
</div>

</div>
</div>
<a id="a81eccf5a903a575f17d799d959397f61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81eccf5a903a575f17d799d959397f61">&#9670;&nbsp;</a></span>cos_zenith_angle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cos_zenith_angle </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>latitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>day_of_year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>hour_of_day</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computation of the cosine of the zenith angle from latitute (<code>lat</code>), day of the year (<code>DOY</code>), and time of day (<code>td</code>).</p>
<p>For the values of angles in radians, we'll use the common practice of denoting the latitude by <code>phi</code> ( <img class="formulaInl" alt="$\phi$" src="form_0.png"/>), the declination by <code>delta</code> ( <img class="formulaInl" alt="$\delta$" src="form_1.png"/>), and the hour angle by <code>tau</code> ( <img class="formulaInl" alt="$\tau$" src="form_2.png"/>). <code>NDS</code> denotes the number of days after December solstice and <code>omega</code> ( <img class="formulaInl" alt="$\omega$" src="form_3.png"/>) denotes the angle (in radians) of the orbital position of the earth around the sun relative to its position at the December solstice.</p>
<p>Denoting the axial tilt of the earth by <img class="formulaInl" alt="$\varepsilon$" src="form_4.png"/>, the equation used for declination (<code>delta</code>) is </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \delta = -\varepsilon \cos(\omega) \]" src="form_5.png"/>
</p>
<p> which is an approximation (always accurate to within 0.26 degrees) of the more accurate formula </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sin(\delta) = -\sin(\varepsilon) \cos(\omega) \]" src="form_6.png"/>
</p>
<p>The cosine of the solar zenith angle <img class="formulaInl" alt="$\theta_s$" src="form_7.png"/> may be calculated from the declination <img class="formulaInl" alt="$\delta$" src="form_1.png"/>, the latitude <img class="formulaInl" alt="$\phi$" src="form_0.png"/>, and the hour angle <img class="formulaInl" alt="$\tau$" src="form_2.png"/> by the formula </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \cos(\theta_s) = \sin(\delta) \sin(\phi) + \cos(\delta) \cos(\phi) \cos(\tau) \]" src="form_8.png"/>
</p>
<p> which is a straight-forward application of the law of cosines for spherical triangles, substituting cofunctions of coangles in the case of latitude and declination. </p>

<p class="definition">Definition at line <a class="el" href="AuxBioCro_8cpp_source.html#l00072">72</a> of file <a class="el" href="AuxBioCro_8cpp_source.html">AuxBioCro.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;{</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    constexpr <span class="keywordtype">double</span> radians_per_degree = math_constants::pi/180;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    constexpr <span class="keywordtype">int</span> solar_noon = 12;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    constexpr <span class="keywordtype">double</span> radians_rotation_per_hour = 15 * radians_per_degree;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    constexpr <span class="keywordtype">double</span> axial_tilt = 23.5 * radians_per_degree;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> phi = latitude * radians_per_degree;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> NDS = day_of_year + 10;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> omega = 360.0 * (NDS / 365.0) * radians_per_degree;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> delta = -axial_tilt * cos(omega);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> tau = (hour_of_day - solar_noon) * radians_rotation_per_hour;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">return</span> sin(delta) * sin(phi) + cos(delta) * cos(phi) * cos(tau);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="AuxBioCro_8cpp_source.html#l00095">lightME()</a>.</p>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="BioCro_8h_a81eccf5a903a575f17d799d959397f61_icgraph.png" border="0" usemap="#BioCro_8h_a81eccf5a903a575f17d799d959397f61_icgraph" alt=""/></div>
<map name="BioCro_8h_a81eccf5a903a575f17d799d959397f61_icgraph" id="BioCro_8h_a81eccf5a903a575f17d799d959397f61_icgraph">
<area shape="rect" title=" " alt="" coords="253,56,376,83"/>
<area shape="rect" href="BioCro_8h.html#a1d896aaaf32c2c9dfce1a53f7d22a884" title=" " alt="" coords="140,56,205,83"/>
<area shape="rect" href="c3CanAC_8cpp.html#abe33cbe09472254ce42dc5ff9f397dd1" title=" " alt="" coords="10,5,87,32"/>
<area shape="rect" href="CanAC_8cpp.html#a201d4294ee9d1b27817aea11f9e53e30" title=" " alt="" coords="17,56,80,83"/>
<area shape="rect" href="canac__with__collatz_8hpp.html#a80bef649007309c406cdbc790a9ef36b" title=" " alt="" coords="5,107,92,133"/>
</map>
</div>

</div>
</div>
<a id="aae32da4734d9888b3d3b1fda9480a129"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae32da4734d9888b3d3b1fda9480a129">&#9670;&nbsp;</a></span>EvapoTrans2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structET__Str.html">ET_Str</a> EvapoTrans2 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Iave</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Airtemperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LeafAreaIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CanopyHeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stomatacond</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eteq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AuxBioCro_8cpp_source.html#l00325">325</a> of file <a class="el" href="AuxBioCro_8cpp_source.html">AuxBioCro.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;{</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    constexpr <span class="keywordtype">double</span> StefanBoltzmann = 5.67037e-8;       <span class="comment">// J / m^2 / s / K^4</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    constexpr <span class="keywordtype">double</span> tau = 0.2;                          <span class="comment">// dimensionless. Leaf transmission coefficient.</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    constexpr <span class="keywordtype">double</span> LeafReflectance = 0.2;              <span class="comment">// dimensionless.</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    constexpr <span class="keywordtype">double</span> SpecificHeat = 1010;                <span class="comment">// J / kg / K</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    constexpr <span class="keywordtype">double</span> molar_mass_of_water = 18.01528e-3;  <span class="comment">// kg / mol</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    constexpr <span class="keywordtype">double</span> R = 8.314472;                       <span class="comment">// joule / kelvin / mole.</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">//constexpr double atmospheric_pressure = 101325;      // Pa</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    CanopyHeight = fmax(0.1, CanopyHeight); <span class="comment">// ensure CanopyHeight &gt;= 0.1</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordtype">double</span> WindSpeedHeight = 2; <span class="comment">// This is the height at which the wind speed was measured.</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">// When the height at which wind was measured is lower than the canopy height, there can be problems with the calculations.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// This is a very crude way of solving this problem.</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">if</span> (WindSpeedHeight &lt; CanopyHeight + 1) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        WindSpeedHeight = CanopyHeight + WindSpeedHeight;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> DdryA = <a class="code" href="AuxBioCro_8cpp.html#a6380d8cd4192408df76baefe6b369a70">TempToDdryA</a>(airTemp);  <span class="comment">// kg / m^3. Density of dry air.,</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> LHV = <a class="code" href="AuxBioCro_8cpp.html#ae810651283c6640ef4669d0eede1c942">TempToLHV</a>(airTemp);  <span class="comment">// J / kg</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> SlopeFS = <a class="code" href="AuxBioCro_8cpp.html#a05f381bbff6170709a8d0e2e34f4556a">TempToSFS</a>(airTemp);  <span class="comment">// kg / m^3 / K. It is also kg / m^3 / degrees C since it&#39;s a change in temperature.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> SWVP = <a class="code" href="AuxBioCro_8cpp.html#a117fba2c85ba6d52345e7cefc05a43ff">saturation_vapor_pressure</a>(airTemp);  <span class="comment">// Pa.</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordtype">double</span> constexpr volume_of_one_mole_of_air = 24.39e-3;  <span class="comment">// m^3 / mol. TODO: This is for about 20 degrees C at 100000 Pa. Change it to use the model state. (1 * R * temperature) / pressure</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordtype">double</span> conductance_in_m_per_s = stomatal_conductance * 1e-3 * volume_of_one_mole_of_air;  <span class="comment">// m / s</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">if</span> (conductance_in_m_per_s &lt;= 0.001) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        conductance_in_m_per_s = 0.001;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">if</span> (RH &gt; 1)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">throw</span> std::range_error(<span class="stringliteral">&quot;Thrown in EvapoTrans2: RH (relative humidity) is greater than 1.&quot;</span>);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> SWVC = SWVP / R / (airTemp + 273.15) * molar_mass_of_water;  <span class="comment">// kg / m^3. Convert from vapor pressure to vapor density using the ideal gas law. This is approximately right for temperatures what won&#39;t kill plants.</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (SWVC &lt; 0)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">throw</span> std::range_error(<span class="stringliteral">&quot;Thrown in EvapoTrans2: SWVC is less than 0.&quot;</span>);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> PsycParam = DdryA * SpecificHeat / LHV;  <span class="comment">// kg / m^3 / K</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> vapor_density_deficit = SWVC * (1 - RH);  <span class="comment">// kg / m^3</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> ActualVaporPressure = RH * SWVP;  <span class="comment">// Pa</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">/* SOLAR RADIATION COMPONENT */</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">// Convert from PPFD to irradiance.</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordtype">double</span> constexpr fraction_of_irradiance_in_PAR = 0.5;  <span class="comment">// dimensionless.</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordtype">double</span> constexpr joules_per_micromole_PAR = 0.235;   <span class="comment">// J / micromole. For the wavelengths that make up PAR in sunlight, one mole of photons has, on average, approximately 2.35 x 10^5 joules:</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> total_irradiance = Rad * joules_per_micromole_PAR / fraction_of_irradiance_in_PAR;  <span class="comment">// W / m^2.</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> total_average_irradiance = Iave * joules_per_micromole_PAR / fraction_of_irradiance_in_PAR;  <span class="comment">// W / m^2</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">/* With a clear sky, irradiance may exceed 1000 W / m^2 in some parts of the world. Thornley and Johnson pg 400. */</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">/* This value cannot possibly be higher than 1300 W / m^2. */</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span> (total_irradiance &gt; 1300) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">throw</span> std::range_error(<span class="stringliteral">&quot;Thrown in EvapoTrans2: total irradiance is &quot;</span> + std::to_string(total_irradiance) + <span class="stringliteral">&quot;, which is too high.&quot;</span>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Ja = total_irradiance * (1 - LeafReflectance - tau) / (1 - tau);  <span class="comment">// W / m^2</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">/* The value below is only for leaf temperature */</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Ja2 = total_average_irradiance * (1 - LeafReflectance - tau) / (1 - tau);  <span class="comment">// W / m^2</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">/* AERODYNAMIC COMPONENT */</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">if</span> (WindSpeed &lt; 0.5) WindSpeed = 0.5;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">/* This is the original from WIMOVAC*/</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordtype">double</span> Deltat = 0.01;  <span class="comment">// degrees C</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordtype">double</span> ga;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordtype">double</span> rlc; <span class="comment">/* Long wave radiation for iterative calculation */</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keywordtype">double</span> ChangeInLeafTemp = 10.0;  <span class="comment">// degrees C</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordtype">double</span> Counter = 0;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            ga = <a class="code" href="AuxBioCro_8cpp.html#ac010f205c5523680171638102192ce39">leaf_boundary_layer_conductance</a>(WindSpeed, leaf_width, airTemp, Deltat, conductance_in_m_per_s, ActualVaporPressure);  <span class="comment">// m / s</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="comment">/* In WIMOVAC, ga was added to the canopy conductance */</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="comment">/* ga = (ga * gbcW)/(ga + gbcW); */</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordtype">double</span> OldDeltaT = Deltat;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            rlc = 4 * StefanBoltzmann * pow(273 + airTemp, 3) * Deltat;  <span class="comment">// W / m^2</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="comment">/* rlc = net long wave radiation emittted per second = radiation emitted per second - radiation absorbed per second = sigma * (Tair + deltaT)^4 - sigma * Tair^4</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">             * To make it a linear function of deltaT, do a Taylor series about deltaT = 0 and keep only the zero and first order terms.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">             * rlc = sigma * Tair^4 + deltaT * (4 * sigma * Tair^3) - sigma * Tair^4 = 4 * sigma * Tair^3 * deltaT</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">             * where 4 * sigma * Tair^3 is the derivative of sigma * (Tair + deltaT)^4 evaluated at deltaT = 0,</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> PhiN2 = Ja2 - rlc;  <span class="comment">// W / m^2</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="comment">/* This equation is from Thornley and Johnson pg. 418 */</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> TopValue = PhiN2 * (1 / ga + 1 / conductance_in_m_per_s) - LHV * vapor_density_deficit;  <span class="comment">// J / m^3</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> BottomValue = LHV * (SlopeFS + PsycParam * (1 + ga / conductance_in_m_per_s));  <span class="comment">// J / m^3 / K</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            Deltat = fmin(fmax(TopValue / BottomValue, -10), 10); <span class="comment">// kelvin. Confine Deltat to the interval [-10, 10]:</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            ChangeInLeafTemp = fabs(OldDeltaT - Deltat);  <span class="comment">// kelvin</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        } <span class="keywordflow">while</span> ( (++Counter &lt;= 10) &amp;&amp; (ChangeInLeafTemp &gt; 0.5) );</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">/* Net radiation */</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> PhiN = fmax(0, Ja - rlc);  <span class="comment">// W / m^2</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">//Rprintf(&quot;SlopeFS %f, PhiN %f, LHV %f, PsycParam %f, ga %f, vapor_density_deficit %f, conductance_in... %f\n&quot;, SlopeFS, PhiN, LHV, PsycParam, ga, vapor_density_deficit, conductance_in_m_per_s);</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> penman_monieth = (SlopeFS * PhiN + LHV * PsycParam * ga * vapor_density_deficit)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        / (LHV * (SlopeFS + PsycParam * (1 + ga / conductance_in_m_per_s)));  <span class="comment">// kg / m^2 / s.  Thornley and Johnson. 1990. Plant and Crop Modeling. Equation 14.4k. Page 408.</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> EPen = (SlopeFS * PhiN + LHV * PsycParam * ga * vapor_density_deficit)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        / (LHV * (SlopeFS + PsycParam));  <span class="comment">// kg / m^2 / s</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> EPries = 1.26 * SlopeFS * PhiN / (LHV * (SlopeFS + PsycParam));  <span class="comment">// kg / m^2 / s</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">/* Choose equation to report */</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordtype">double</span> TransR;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">switch</span> (eteq) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        TransR = EPen;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        TransR = EPries;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        TransR = penman_monieth;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">// TransR has units of kg / m^2 / s.</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">// Convert to mm / m^2 / s.</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">/* 1e3 - g / kg  */</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">/* 18 - g / mol for water */</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">/* 1e3 - mmol / mol */</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keyword">struct </span><a class="code" href="structET__Str.html">ET_Str</a> et_results;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    et_results.<a class="code" href="structET__Str.html#a6459f6ef779feb02861948dc4f4b06f0">TransR</a> = <a class="code" href="structET__Str.html#a6459f6ef779feb02861948dc4f4b06f0">TransR</a> * 1e3 * 1e3 / 18;    <span class="comment">// mmol / m^2 / s</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    et_results.EPenman = EPen * 1e3 * 1e3 / 18;     <span class="comment">// mmol / m^2 / s</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    et_results.EPriestly = EPries * 1e3 * 1e3 / 18; <span class="comment">// mmol / m^2 / s</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    et_results.Deltat = <a class="code" href="structET__Str.html#af1313b200fdfaf71c6d4ee070ddeaf8c">Deltat</a>;                     <span class="comment">// degrees C</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">return</span> et_results;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f6a4f8b6e407fdca09efcebc32bf86c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f6a4f8b6e407fdca09efcebc32bf86c">&#9670;&nbsp;</a></span>flow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct flow_str flow </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CNratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Lc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Tm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ks</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab1f878344b2d2444f096bd0da2cb9f24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1f878344b2d2444f096bd0da2cb9f24">&#9670;&nbsp;</a></span>FmLcFun()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct FL_str FmLcFun </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Lig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Nit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1d896aaaf32c2c9dfce1a53f7d22a884"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d896aaaf32c2c9dfce1a53f7d22a884">&#9670;&nbsp;</a></span>lightME()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structLight__model.html">Light_model</a> lightME </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>latitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>day_of_year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>hour_of_day</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Light Macro Environment </p>

<p class="definition">Definition at line <a class="el" href="AuxBioCro_8cpp_source.html#l00095">95</a> of file <a class="el" href="AuxBioCro_8cpp_source.html">AuxBioCro.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;{</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// day_of_year and hour_of_day are given as local time for the specified latitude.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// Return values.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">//  light_model.direct_irradiance_fraction: The fraction of irradiance that is direct radiation. dimensionless.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">//  light_model.diffuse_irradiance_fraction: The fraction of irradiance that is diffuse radiation. dimensionless.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">//  light_model.cosine_zenith_angle: The cosine of the zenith angle of the Sun. When the Sun is directly overhead, the angle is 0 and cos(angle) is 1. dimensionless.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// The basis for this function is given in chapter 11 of Norman and Campbell. An Introduction to Environmental Biophysics. 2nd edition.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> cosine_zenith_angle = <a class="code" href="AuxBioCro_8cpp.html#a81eccf5a903a575f17d799d959397f61">cos_zenith_angle</a>(latitude, day_of_year, hour_of_day);  <span class="comment">// dimensionless.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">double</span> direct_irradiance_transmittance;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">double</span> diffuse_irradiance_transmittance;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">if</span> (cosine_zenith_angle &lt;= 0) { <span class="comment">// Check if the Sun is at or below the horizon. If it is, directly set direct_irradiance_transmittance and diffuse_irradiance_transmittance because the equations below would otherwise produce erroneous results. The Sun is at or below the horizon when cosine_zenith_angle is less than or equal to 0.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        direct_irradiance_transmittance = 0;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        diffuse_irradiance_transmittance = 1;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// If the Sun is above the horizon, calculate diffuse and direct irradiance from the Sun&#39;s angle to the ground and the path through the atmosphere.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        constexpr <span class="keywordtype">double</span> atmospheric_transmittance = 0.85; <span class="comment">// dimensionless.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        constexpr <span class="keywordtype">double</span> atmospheric_pressure_at_sea_level = 1e5; <span class="comment">// Pa.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        constexpr <span class="keywordtype">double</span> local_atmospheric_pressure = 1e5; <span class="comment">// Pa.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        constexpr <span class="keywordtype">double</span> pressure_ratio = local_atmospheric_pressure / atmospheric_pressure_at_sea_level; <span class="comment">// dimensionless.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        constexpr <span class="keywordtype">double</span> proportion_of_irradiance_scattered = 0.3; <span class="comment">// dimensionless.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        direct_irradiance_transmittance = pow(atmospheric_transmittance, (pressure_ratio / cosine_zenith_angle)); <span class="comment">// Modified from equation 11.11 of Norman and Campbell.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        diffuse_irradiance_transmittance = proportion_of_irradiance_scattered * (1 - direct_irradiance_transmittance) * cosine_zenith_angle; <span class="comment">// Modified from equation 11.13 of Norman and Campbell.</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="structLight__model.html">Light_model</a> light_model;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    light_model.<a class="code" href="structLight__model.html#a29f813f0ce340f3d02748daffbec5200">direct_irradiance_fraction</a> = direct_irradiance_transmittance / (direct_irradiance_transmittance + diffuse_irradiance_transmittance); <span class="comment">// dimensionless.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    light_model.<a class="code" href="structLight__model.html#a5ecfb901306b14488b8b3e2e851f63b6">diffuse_irradiance_fraction</a> = diffuse_irradiance_transmittance / (direct_irradiance_transmittance + diffuse_irradiance_transmittance); <span class="comment">// dimensionless.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    light_model.<a class="code" href="structLight__model.html#a8ad7918d4aada10f0c64e073da9c4ff4">cosine_zenith_angle</a> = cosine_zenith_angle; <span class="comment">// dimensionless.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">return</span> light_model;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="AuxBioCro_8cpp_source.html#l00072">cos_zenith_angle()</a>, <a class="el" href="BioCro_8h_source.html#l00012">Light_model::cosine_zenith_angle</a>, <a class="el" href="BioCro_8h_source.html#l00011">Light_model::diffuse_irradiance_fraction</a>, and <a class="el" href="BioCro_8h_source.html#l00010">Light_model::direct_irradiance_fraction</a>.</p>

<p class="reference">Referenced by <a class="el" href="c3CanAC_8cpp_source.html#l00004">c3CanAC()</a>, <a class="el" href="CanAC_8cpp_source.html#l00004">CanAC()</a>, and <a class="el" href="canac__with__collatz_8hpp_source.html#l00011">newCanAC()</a>.</p>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="BioCro_8h_a1d896aaaf32c2c9dfce1a53f7d22a884_cgraph.png" border="0" usemap="#BioCro_8h_a1d896aaaf32c2c9dfce1a53f7d22a884_cgraph" alt=""/></div>
<map name="BioCro_8h_a1d896aaaf32c2c9dfce1a53f7d22a884_cgraph" id="BioCro_8h_a1d896aaaf32c2c9dfce1a53f7d22a884_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,71,32"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a81eccf5a903a575f17d799d959397f61" title=" " alt="" coords="119,5,241,32"/>
</map>
</div>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="BioCro_8h_a1d896aaaf32c2c9dfce1a53f7d22a884_icgraph.png" border="0" usemap="#BioCro_8h_a1d896aaaf32c2c9dfce1a53f7d22a884_icgraph" alt=""/></div>
<map name="BioCro_8h_a1d896aaaf32c2c9dfce1a53f7d22a884_icgraph" id="BioCro_8h_a1d896aaaf32c2c9dfce1a53f7d22a884_icgraph">
<area shape="rect" title=" " alt="" coords="140,56,205,83"/>
<area shape="rect" href="c3CanAC_8cpp.html#abe33cbe09472254ce42dc5ff9f397dd1" title=" " alt="" coords="10,5,87,32"/>
<area shape="rect" href="CanAC_8cpp.html#a201d4294ee9d1b27817aea11f9e53e30" title=" " alt="" coords="17,56,80,83"/>
<area shape="rect" href="canac__with__collatz_8hpp.html#a80bef649007309c406cdbc790a9ef36b" title=" " alt="" coords="5,107,92,133"/>
</map>
</div>

</div>
</div>
<a id="aeb35169469ef33705592a28743d105bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb35169469ef33705592a28743d105bf">&#9670;&nbsp;</a></span>resp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double resp </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AuxBioCro_8cpp_source.html#l00903">903</a> of file <a class="el" href="AuxBioCro_8cpp_source.html">AuxBioCro.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                                  {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordtype">double</span> ans = comp *  (1 - (mrc * pow(2, (temp / 10.0))));</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">if</span> (ans &lt;0) ans = 0;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa4d2cdd07093428af4830f4c8afd660c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4d2cdd07093428af4830f4c8afd660c">&#9670;&nbsp;</a></span>RHprof()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RHprof </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>relative_humidity_profile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Preconditions: <code>RH</code> is between 0 and 1. <code>nlayers</code> is at least 1 and at most MAXLAY. <code>relative_humidity_profile</code> is an array of at least size <code>nlayers</code>.</p>
<p>Postconditions: <code>relative_humidity_profile</code> contains values between 0 and 1. </p>

<p class="definition">Definition at line <a class="el" href="AuxBioCro_8cpp_source.html#l00255">255</a> of file <a class="el" href="AuxBioCro_8cpp_source.html">AuxBioCro.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;{</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span> (RH &gt; 1 || RH &lt; 0) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;RH must be between 0 and 1.&quot;</span>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">if</span> (nlayers &lt; 1 || nlayers &gt; <a class="code" href="AuxBioCro_8h.html#a57179778cb6aed95fb9f484b55873d6f">MAXLAY</a>) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;nlayers must be at least 1 but no more than MAXLAY.&quot;</span>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> kh = 1 - RH;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nlayers; ++i)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordtype">double</span> j = i + 1;  <span class="comment">// Explicitly make j a double so that j / nlayers isn&#39;t truncated.</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordtype">double</span> temp_rh = RH * exp(kh * (j / nlayers));</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        relative_humidity_profile[i] = temp_rh;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="AuxBioCro_8h_source.html#l00017">MAXLAY</a>.</p>

<p class="reference">Referenced by <a class="el" href="c3CanAC_8cpp_source.html#l00004">c3CanAC()</a>, <a class="el" href="CanAC_8cpp_source.html#l00004">CanAC()</a>, <a class="el" href="canac__with__collatz_8hpp_source.html#l00011">newCanAC()</a>, and <a class="el" href="multilayer__canopy__properties_8h_source.html#l00184">multilayer_canopy_properties::run()</a>.</p>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="BioCro_8h_aa4d2cdd07093428af4830f4c8afd660c_icgraph.png" border="0" usemap="#BioCro_8h_aa4d2cdd07093428af4830f4c8afd660c_icgraph" alt=""/></div>
<map name="BioCro_8h_aa4d2cdd07093428af4830f4c8afd660c_icgraph" id="BioCro_8h_aa4d2cdd07093428af4830f4c8afd660c_icgraph">
<area shape="rect" title=" " alt="" coords="267,81,329,108"/>
<area shape="rect" href="c3CanAC_8cpp.html#abe33cbe09472254ce42dc5ff9f397dd1" title=" " alt="" coords="73,5,151,32"/>
<area shape="rect" href="CanAC_8cpp.html#a201d4294ee9d1b27817aea11f9e53e30" title=" " alt="" coords="81,56,143,83"/>
<area shape="rect" href="canac__with__collatz_8hpp.html#a80bef649007309c406cdbc790a9ef36b" title=" " alt="" coords="69,107,155,133"/>
<area shape="rect" href="classmultilayer__canopy__properties.html#a12f0b07cdb6505cf1cfc91773b9e1fd4" title=" " alt="" coords="5,157,219,184"/>
</map>
</div>

</div>
</div>
<a id="ad6f4cf8654e6db407d4d453834c1807c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6f4cf8654e6db407d4d453834c1807c">&#9670;&nbsp;</a></span>SoilEvapo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SoilEvapo </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>AirTemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>DirectRad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>awc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fieldc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiltp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>winds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_clod_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_reflectance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_transmission</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>specific_heat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stefan_boltzman</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AuxBioCro_8cpp_source.html#l00536">536</a> of file <a class="el" href="AuxBioCro_8cpp_source.html">AuxBioCro.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;{</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordtype">int</span> method = 1;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">/* A simple way of calculating the proportion of the soil that is hit by direct radiation. */</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordtype">double</span> soil_area_sunlit_fraction = exp(-k * LAI);  <span class="comment">// dimensionless.</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">/* For now the temperature of the soil will be the same as the air.</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">       At a later time this can be made more accurate. I looked at the equations for this and the issue is that it is strongly dependent on</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">       depth. Since the soil model now has a single layer, this cannot be implemented correctly at the moment.  */</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordtype">double</span> SoilTemp = air_temperature;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">/* From Campbell and Norman. Environmental Biophysics. */</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">/* If relative available water content is */</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordtype">double</span> rawc = (soil_water_content - wiltp) / (fieldc - wiltp);  <span class="comment">// dimensionless. relative available water content.</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">/* Campbell and Norman. Environmental Physics, page 142 */</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordtype">double</span> maximum_uptake_rate = 1 - pow((1 + 1.3 * rawc), -5);  <span class="comment">// dimenionless</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">/* This is a useful idea because dry soils evaporate little water when dry*/</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">/* Total Radiation */</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">/* Convert light assuming 1 micromole PAR photons = 0.235 J/s Watts*/</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">/* At the moment soil evaporation is grossly overestimated. In WIMOVAC the light reaching the last layer of leaves is used. Here instead</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">       of calculating this again, I will for now assume a 10% as a rough estimate. Note that I could maybe get this since layIdir and</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">       layIDiff in sunML are external variables.  Rprintf(&quot;ppfd %.5f&quot;,layIdir[0],&quot;\n&quot;); Update: 03-13-2009. I tried printing this</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">       value but it is still too high and will likely overestimate soil evaporation. However, this is still a work in progress.</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    ppfd *= rsec; <span class="comment">/* Radiation soil evaporation coefficient */</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordtype">double</span> TotalRadiation = ppfd * 0.235;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordtype">double</span> DdryA = <a class="code" href="AuxBioCro_8cpp.html#a6380d8cd4192408df76baefe6b369a70">TempToDdryA</a>(air_temperature);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordtype">double</span> LHV = <a class="code" href="AuxBioCro_8cpp.html#ae810651283c6640ef4669d0eede1c942">TempToLHV</a>(air_temperature);  <span class="comment">// J / kg</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordtype">double</span> SlopeFS = <a class="code" href="AuxBioCro_8cpp.html#a05f381bbff6170709a8d0e2e34f4556a">TempToSFS</a>(air_temperature);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordtype">double</span> SWVC = <a class="code" href="AuxBioCro_8cpp.html#a117fba2c85ba6d52345e7cefc05a43ff">saturation_vapor_pressure</a>(air_temperature) * 1e-5;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordtype">double</span> PsycParam = (DdryA * specific_heat) / LHV;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordtype">double</span> vapor_density_deficit = SWVC * (1 - RelH / 100);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordtype">double</span> BoundaryLayerThickness = 4e-3 * sqrt(soil_clod_size / winds);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordtype">double</span> DiffCoef = 2.126e-5 * 1.48e-7 * SoilTemp;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordtype">double</span> SoilBoundaryLayer = DiffCoef / BoundaryLayerThickness;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordtype">double</span> Ja = 2 * TotalRadiation * ((1 - soil_reflectance - soil_transmission) / (1 - soil_transmission));</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordtype">double</span> rlc = 4 * stefan_boltzman * pow((273 + SoilTemp), 3) * 0.005;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">/* the last term should be the difference between air temperature and soil. This is not actually calculated at the moment. Since this is</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">       mostly relevant to the first soil layer where the temperatures are similar. I will leave it like this for now. */</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordtype">double</span> PhiN = Ja - rlc; <span class="comment">/* Calculate the net radiation balance*/</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">if</span> (PhiN &lt; 0) PhiN = 1e-7;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordtype">double</span> Evaporation = 0.0;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">if</span> (method == 0) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="comment">/* Priestly-Taylor */</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        Evaporation = 1.26 * (SlopeFS * PhiN) / (LHV * (SlopeFS + PsycParam));  <span class="comment">// kg / m^2 / s.</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="comment">/* Penman-Monteith */</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        Evaporation = (SlopeFS * PhiN + LHV * PsycParam * SoilBoundaryLayer * vapor_density_deficit) / (LHV * (SlopeFS + PsycParam));  <span class="comment">// kg / m^2 / s.</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    }</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    Evaporation *= soil_area_sunlit_fraction * maximum_uptake_rate;  <span class="comment">// kg / m^2 / s.</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">if</span> (Evaporation &lt; 0) Evaporation = 1e-6;  <span class="comment">// Prevent odd values at very low light levels.</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">return</span> Evaporation;  <span class="comment">// kg / m^2 / s.</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="AuxBioCro_8cpp_source.html#l00325">saturation_vapor_pressure()</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00284">TempToDdryA()</a>, <a class="el" href="AuxBioCro_8cpp_source.html#l00301">TempToLHV()</a>, and <a class="el" href="AuxBioCro_8cpp_source.html#l00319">TempToSFS()</a>.</p>
<div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="BioCro_8h_ad6f4cf8654e6db407d4d453834c1807c_cgraph.png" border="0" usemap="#BioCro_8h_ad6f4cf8654e6db407d4d453834c1807c_cgraph" alt=""/></div>
<map name="BioCro_8h_ad6f4cf8654e6db407d4d453834c1807c_cgraph" id="BioCro_8h_ad6f4cf8654e6db407d4d453834c1807c_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,85,108"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a117fba2c85ba6d52345e7cefc05a43ff" title=" " alt="" coords="133,5,308,32"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a6380d8cd4192408df76baefe6b369a70" title=" " alt="" coords="168,56,273,83"/>
<area shape="rect" href="AuxBioCro_8cpp.html#ae810651283c6640ef4669d0eede1c942" title=" " alt="" coords="172,107,269,133"/>
<area shape="rect" href="AuxBioCro_8cpp.html#a05f381bbff6170709a8d0e2e34f4556a" title=" " alt="" coords="173,157,269,184"/>
</map>
</div>

</div>
</div>
<a id="a240cad92527a319dd4e8e0d32cd821e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a240cad92527a319dd4e8e0d32cd821e6">&#9670;&nbsp;</a></span>soilML()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsoilML__str.html">soilML_str</a> soilML </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precipit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soildepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>depths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_field_capacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_wilting_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_saturation_capacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_air_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_saturated_conductivity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_b_coefficient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_sand_content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wsFun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rootDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>AirTemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>IRad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>winds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hydrDist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_clod_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_reflectance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_transmission</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>specific_heat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stefan_boltzman</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AuxBioCro_8cpp_source.html#l00604">604</a> of file <a class="el" href="AuxBioCro_8cpp_source.html">AuxBioCro.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;{</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    constexpr <span class="keywordtype">double</span> g = 9.8; <span class="comment">/* m / s-2  ##  http://en.wikipedia.org/wiki/Standard_gravity */</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <a class="code" href="structsoilML__str.html">soilML_str</a> return_value;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">/* Crude empirical relationship between root biomass and rooting depth*/</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordtype">double</span> rootDepth = fmin(rootDB * rsdf, soildepth);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <a class="code" href="structrd__str.html">rd_str</a> root_distribution = <a class="code" href="AuxBioCro_8cpp.html#ada4de667caf80cb05fccaff44cccb9b1">rootDist</a>(layers, rootDepth, &amp;depths[0], rfl);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">/* unit conversion for precip */</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordtype">double</span> oldWaterIn = 0.0;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordtype">double</span> waterIn = precipit * 1e-3; <span class="comment">/* convert precip in mm to m */</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordtype">double</span> drainage = 0.0;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordtype">double</span> wsPhotoCol = 0.0;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordtype">double</span> LeafWSCol = 0.0;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordtype">double</span> Sevap = 0.0;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordtype">double</span> oldEvapoTra = 0.0;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = layers - 1; i &gt;= 0; --i) { <span class="comment">/* The counter, i, decreases because I increase the water content due to precipitation in the last layer first*/</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="keywordtype">double</span> layerDepth = depths[i+1] - depths[i];  <span class="comment">/* This supports unequal depths. */</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="keywordflow">if</span> (hydrDist &gt; 0) {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="comment">/* For this section see Campbell and Norman &quot;Environmental BioPhysics&quot; Chapter 9*/</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <span class="comment">/* First compute the matric potential */</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <span class="keywordtype">double</span> psim1 = soil_air_entry * pow((cws[i]/soil_saturation_capacity), -soil_b_coefficient); <span class="comment">/* This is matric potential of current layer */</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="keywordtype">double</span> dPsim;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="keywordflow">if</span> (i &gt; 0) {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                <span class="keywordtype">double</span> psim2 = soil_air_entry * pow((cws[i-1]/soil_saturation_capacity), -soil_b_coefficient); <span class="comment">/* This is matric potential of next layer */</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                dPsim = psim1 - psim2;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                <span class="comment">/* The substraction is from the layer i - (i-1). If this last term is positive then it will move upwards. If it is negative it will move downwards. Presumably this term is almost always positive. */</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                dPsim = 0.0;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            <span class="keywordtype">double</span> K_psim = soil_saturated_conductivity * pow((soil_air_entry/psim1), 2+3/soil_b_coefficient); <span class="comment">/* This is hydraulic conductivity */</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            <span class="keywordtype">double</span> J_w = K_psim * (dPsim/layerDepth) - g * K_psim; <span class="comment">/*  Campbell, pg 129 do not ignore the graviational effect*/</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            <span class="comment">/* Notice that K_psim is positive because my reference system is reversed */</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <span class="comment">/* This last result should be in kg/(m2 * s) */</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            J_w *= 3600 * 0.9882 * 1e-3; <span class="comment">/* This is flow in m3 / (m^2 * hr). */</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="keywordflow">if</span> (i == (layers-1) &amp;&amp; J_w &lt; 0) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                <span class="comment">/* cws[i] = cws[i] + J_w / layerDepth; Although this should be done it drains the last layer too much.*/</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                drainage += J_w;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                    cws[i] = cws[i] - J_w / layerDepth;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                <span class="keywordflow">if</span> (i &gt; 0) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                    cws[i - 1] = cws[i - 1] + J_w / layerDepth;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordflow">if</span> (cws[i] &gt; soil_saturation_capacity) cws[i] = soil_saturation_capacity;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keywordflow">if</span> (cws[i] &lt; soil_wilting_point) cws[i] = soil_wilting_point;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="comment">// Here is a convention aw is available water in volume and awc</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="comment">// is available water content as a fraction of the soil section being investigated.</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="keywordtype">double</span> aw = cws[i] * layerDepth;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <span class="comment">/* Available water (for this layer) is the current water status times the layer depth */</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">if</span> (waterIn &gt; 0) {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="comment">/* There is some rain. Need to add it.*/</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            aw += waterIn / layers + oldWaterIn; <span class="comment">/* They are both in meters so it works */</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <span class="comment">/* Adding the same amount to water to each layer */</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <span class="comment">/* In case there is overflow */</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="keywordtype">double</span> diffw = soil_field_capacity * layerDepth - aw;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <span class="keywordflow">if</span> (diffw &lt; 0) {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                <span class="comment">/* This means that precipitation exceeded the capacity of the first layer */</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                <span class="comment">/* Save this amount of water for the next layer */</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                oldWaterIn = -diffw;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                aw = soil_field_capacity * layerDepth;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                oldWaterIn = 0.0;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="comment">/* Root Biomass */</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keywordtype">double</span> rootATdepth = rootDB * root_distribution.<a class="code" href="structrd__str.html#a72c08ee2378ad2245439d54ff775b4de">rootDist</a>[i];</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        return_value.<a class="code" href="structsoilML__str.html#a4ff288d6741c98f41855d489942ab1af">rootDist</a>[i] = rootATdepth;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="comment">/* Plant available water is only between current water status and permanent wilting point */</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="comment">/* Plant available water */</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="keywordtype">double</span> pawha = (aw - soil_wilting_point * layerDepth) * 1e4;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keywordflow">if</span> (pawha &lt; 0) pawha = 0;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="keywordtype">double</span> Ctransp = 0.0;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="keywordtype">double</span> EvapoTra = 0.0;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordtype">double</span> Newpawha;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            <span class="comment">/* Only the first layer is affected by soil evaporation */</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            <span class="keywordtype">double</span> awc2 = aw / layerDepth;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            <span class="comment">/* SoilEvapo function needs soil water content  */</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            Sevap = <a class="code" href="AuxBioCro_8cpp.html#ae4f33badbbdb16dada45516a54bdc4a0">SoilEvapo</a>(LAI, k, AirTemp, IRad, awc2, soil_field_capacity, soil_wilting_point, winds, RelH, rsec,</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                soil_clod_size, soil_reflectance, soil_transmission, specific_heat, stefan_boltzman ) * 3600 * 1e-3 * 10000;  <span class="comment">// Mg / ha / hr. 3600 s / hr * 1e-3 Mg / kg * 10000 m^2 / ha.</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            <span class="comment">/* I assume that crop transpiration is distributed simlarly to</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">               root density.  In other words the crop takes up water proportionally</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">               to the amount of root in each respective layer.*/</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            Ctransp = transp * root_distribution.<a class="code" href="structrd__str.html#a72c08ee2378ad2245439d54ff775b4de">rootDist</a>[0];</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            EvapoTra = Ctransp + Sevap;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            constexpr <span class="keywordtype">double</span> density_of_water_at_20_celcius = 0.9982;  <span class="comment">// Mg m^-3.</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            Newpawha = pawha - EvapoTra / density_of_water_at_20_celcius;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <span class="comment">/* The first term in the rhs pawha is the m3 of water available in this layer.</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">               EvapoTra is the Mg H2O ha-1 of transpired and evaporated water. 1/0.9882 converts from Mg to m3 */</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            Ctransp = transp * root_distribution.<a class="code" href="structrd__str.html#a72c08ee2378ad2245439d54ff775b4de">rootDist</a>[i];</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            EvapoTra = Ctransp;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            Newpawha = pawha - (EvapoTra + oldEvapoTra);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        }</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="keywordflow">if</span> (Newpawha &lt; 0) {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="comment">/* If the Demand is not satisfied by this layer. This will be stored and added to subsequent layers*/</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            oldEvapoTra = -Newpawha;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            aw = soil_wilting_point * layerDepth;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        }</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordtype">double</span> awc = Newpawha / 1e4 / layerDepth + soil_wilting_point;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="comment">/* This might look like a weird place to populate the structure, but is more convenient*/</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        return_value.<a class="code" href="structsoilML__str.html#a7f3063e129dc6591454f7b5050eb3d6c">cws</a>[i] = awc;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="comment">// To-do: Replace this block with a call to compute_wsPhoto.</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="comment">/* three different type of equations for modeling the effect of water stress on vmax and leaf area expansion.</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">       The equation for leaf area expansion is more severe than the one for vmax. */</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="keywordtype">double</span> wsPhoto = 0.0;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="keywordtype">double</span> slp = 0.0;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="keywordtype">double</span> intcpt = 0.0;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="keywordtype">double</span> theta = 0.0;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <span class="keywordflow">if</span> (wsFun == 0) { <span class="comment">/* linear */</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            slp = 1/(soil_field_capacity - soil_wilting_point);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            intcpt = 1 - soil_field_capacity * slp;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            wsPhoto = slp * awc + intcpt;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wsFun == 1) {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <span class="keywordtype">double</span> phi10 = (soil_field_capacity + soil_wilting_point)/2;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            wsPhoto = 1/(1 + exp((phi10 - awc)/ phi1));</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wsFun == 2) {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            slp = (1 - soil_wilting_point)/(soil_field_capacity - soil_wilting_point);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            intcpt = 1 - soil_field_capacity * slp;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            theta = slp * awc + intcpt;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            wsPhoto = (1 - exp(-2.5 * (theta - soil_wilting_point)/(1 - soil_wilting_point))) / (1 - exp(-2.5));</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wsFun == 3) {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            wsPhoto = 1;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordflow">if</span> (wsPhoto &lt;= 0 )</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            wsPhoto = 1e-10; <span class="comment">/* This can be mathematically lower than zero in some cases but I should prevent that. */</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        wsPhotoCol += wsPhoto;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="keywordtype">double</span> LeafWS = pow(awc, phi2) * 1/pow(soil_field_capacity, phi2);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">if</span> (wsFun == 3) {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            LeafWS = 1;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        LeafWSCol += LeafWS;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">if</span> (waterIn &gt; 0) {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        drainage = waterIn;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="comment">/* Need to convert to units used in the Parton et al 1988 paper. */</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="comment">/* The data comes in mm/hr and it needs to be in cm/month */</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        return_value.<a class="code" href="structsoilML__str.html#a01cde156faa3f11579218b3759f5f126">Nleach</a> = drainage * 0.1 * (1/24 * 30) / (18 * (0.2 + 0.7 * soil_sand_content));</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        return_value.<a class="code" href="structsoilML__str.html#a01cde156faa3f11579218b3759f5f126">Nleach</a> = 0.0;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    return_value.<a class="code" href="structsoilML__str.html#a18a83a9cab2ee1fe35ec98a9a3a7a7c8">rcoefPhoto</a> = (wsPhotoCol/layers);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    return_value.<a class="code" href="structsoilML__str.html#aa4ad1174e804109cf6b5c675c37b3f8c">drainage</a> = drainage;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    return_value.<a class="code" href="structsoilML__str.html#a61a206aa7c24239e09e3d717368665a5">rcoefSpleaf</a> = (LeafWSCol/layers);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    return_value.<a class="code" href="structsoilML__str.html#ad1c34d3fec2b0784367f785d57906217">SoilEvapo</a> = Sevap;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">return</span> return_value;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae405c9aa7474b930996999660001cd00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae405c9aa7474b930996999660001cd00">&#9670;&nbsp;</a></span>sunML()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structLight__profile.html">Light_profile</a> sunML </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Idir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Idiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cosTheta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computation of an n-layered light profile from the direct light <code>Idir</code>, diffuse light <code>Idiff</code>, leaf area index <code>LAI</code>, the cosine of the zenith angle <code>cosTheta</code> and other parameters.</p>
<p>Preconditions: <code>Idir</code> and <code>Idiff</code> are positive. <code>LAI</code> is non-negative. <code>nlayers</code> is at least 1 and not more than MAXLAY, the compile-time constant defining the maximum array size for arrays used to store profile data (enforced). <code>cosTheta</code> is greater than 0 and at most 1 (enforced). <code>kd</code> is between 0 and 1. <code>chil</code> is non-negative. <code>heightf</code> is positive. </p>

<p class="definition">Definition at line <a class="el" href="AuxBioCro_8cpp_source.html#l00149">149</a> of file <a class="el" href="AuxBioCro_8cpp_source.html">AuxBioCro.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;{</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (nlayers &lt; 1 || nlayers &gt; <a class="code" href="AuxBioCro_8h.html#a57179778cb6aed95fb9f484b55873d6f">MAXLAY</a>) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;nlayers must be at least 1 but no more than MAXLAY.&quot;</span>);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">if</span> (cosTheta &gt; 1 || cosTheta &lt; -1) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;cosTheta must be between -1 and 1.&quot;</span>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">if</span> (kd &gt; 1 || kd &lt; 0) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;kd must be between 0 and 1.&quot;</span>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span> (chil &lt; 0) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;chil must be non-negative.&quot;</span>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> (heightf &lt;= 0) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;heightf must greater than zero.&quot;</span>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    constexpr <span class="keywordtype">double</span> alphascatter = 0.8;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">double</span> theta = acos(cosTheta);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">double</span> k0 = sqrt( pow(chil, 2) + pow(tan(theta), 2) );</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordtype">double</span> k1 = chil + 1.744 * pow((chil + 1.183), -0.733);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">double</span> k = k0 / k1;  <span class="comment">// Canopy extinction coefficient for an ellipsoidal leaf angle distribution. Page 251, Campbell and Norman. Environmental Biophysics. second edition.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">double</span> LAIi = LAI / nlayers;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="structLight__profile.html">Light_profile</a> light_profile;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Ibeam = Idir * cosTheta;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">double</span> Isolar = Ibeam * k;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nlayers; ++i) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> CumLAI = LAIi * (i + 0.5);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> Iscat = Ibeam * (exp(-k * sqrt(alphascatter) * CumLAI) - exp(-k * CumLAI));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordtype">double</span> Idiffuse = Idiff * exp(-kd * CumLAI) + Iscat;  <span class="comment">// The exponential term is equation 15.6, pg 255 of Campbell and Normal. Environmental Biophysics. with alpha=1 and Kbe(phi) = Kd.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> Ls = (1 - exp(-k * LAIi)) * exp(-k * CumLAI) / k;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordtype">double</span> Fsun = Ls / LAIi;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordtype">double</span> Fshade = 1 - Fsun;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordtype">double</span> Iaverage = (Fsun * (Isolar + Idiffuse) + Fshade * Idiffuse) * (1 - exp(-k * LAIi)) / k;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="comment">// For values of cosTheta close to or less than 0, in place of the</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment">// calculations above, we want to use the limits of the above</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="comment">// expressions as cosTheta approaches 0 from the right:</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">if</span> (cosTheta &lt;= 1E-10) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            Isolar = Idir / k1;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            Idiffuse = Idiff * exp(-kd * CumLAI);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            Fsun = 0;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            Fshade = 1;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            Iaverage = 0;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        light_profile.<a class="code" href="structLight__profile.html#a2f8231e1e3f6b0c04e8a08ddcc419e03">direct_irradiance</a>[i] = Isolar + Idiffuse;  <span class="comment">// micromole / m^2 / s</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        light_profile.<a class="code" href="structLight__profile.html#a49cce1a633a8cb676490a30f16b5d761">scattered_irradiance</a>[i] = Iscat;  <span class="comment">// micromole / m^2 / s</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        light_profile.<a class="code" href="structLight__profile.html#a3a64c8a4ce00e9190ec3f3b8b7233817">diffuse_irradiance</a>[i]= Idiffuse;  <span class="comment">// micromole / m^2 / s</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        light_profile.<a class="code" href="structLight__profile.html#a424cf9cc81031798184256d14a08786a">total_irradiance</a>[i] = Iaverage;  <span class="comment">// micromole / m^2 / s</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        light_profile.<a class="code" href="structLight__profile.html#a5ab1c660a6d5af30163325103043a419">sunlit_fraction</a>[i] = Fsun;  <span class="comment">// dimensionless from m^2 / m^2</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        light_profile.<a class="code" href="structLight__profile.html#a61e74afb9cc127be0696334b9a1ffdc8">shaded_fraction</a>[i] = Fshade;  <span class="comment">// dimensionless from m^2 / m^2</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        light_profile.<a class="code" href="structLight__profile.html#ab9551f243ec3ef975ebb13d1566aa75a">height</a>[i] = (LAI - CumLAI) / heightf;  <span class="comment">// meters</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">return</span> light_profile;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="AuxBioCro_8h_source.html#l00031">Light_profile::diffuse_irradiance</a>, <a class="el" href="AuxBioCro_8h_source.html#l00029">Light_profile::direct_irradiance</a>, <a class="el" href="AuxBioCro_8h_source.html#l00035">Light_profile::height</a>, <a class="el" href="AuxBioCro_8h_source.html#l00017">MAXLAY</a>, <a class="el" href="AuxBioCro_8h_source.html#l00030">Light_profile::scattered_irradiance</a>, <a class="el" href="AuxBioCro_8h_source.html#l00034">Light_profile::shaded_fraction</a>, <a class="el" href="AuxBioCro_8h_source.html#l00033">Light_profile::sunlit_fraction</a>, and <a class="el" href="AuxBioCro_8h_source.html#l00032">Light_profile::total_irradiance</a>.</p>

<p class="reference">Referenced by <a class="el" href="c3CanAC_8cpp_source.html#l00004">c3CanAC()</a>, <a class="el" href="CanAC_8cpp_source.html#l00004">CanAC()</a>, <a class="el" href="canac__with__collatz_8hpp_source.html#l00011">newCanAC()</a>, and <a class="el" href="multilayer__canopy__properties_8h_source.html#l00184">multilayer_canopy_properties::run()</a>.</p>
<div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="BioCro_8h_ae405c9aa7474b930996999660001cd00_icgraph.png" border="0" usemap="#BioCro_8h_ae405c9aa7474b930996999660001cd00_icgraph" alt=""/></div>
<map name="BioCro_8h_ae405c9aa7474b930996999660001cd00_icgraph" id="BioCro_8h_ae405c9aa7474b930996999660001cd00_icgraph">
<area shape="rect" title=" " alt="" coords="267,81,329,108"/>
<area shape="rect" href="c3CanAC_8cpp.html#abe33cbe09472254ce42dc5ff9f397dd1" title=" " alt="" coords="73,5,151,32"/>
<area shape="rect" href="CanAC_8cpp.html#a201d4294ee9d1b27817aea11f9e53e30" title=" " alt="" coords="81,56,143,83"/>
<area shape="rect" href="canac__with__collatz_8hpp.html#a80bef649007309c406cdbc790a9ef36b" title=" " alt="" coords="69,107,155,133"/>
<area shape="rect" href="classmultilayer__canopy__properties.html#a12f0b07cdb6505cf1cfc91773b9e1fd4" title=" " alt="" coords="5,157,219,184"/>
</map>
</div>

</div>
</div>
<a id="a5039fd6db860b5b611fb3c90b00ef7e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5039fd6db860b5b611fb3c90b00ef7e8">&#9670;&nbsp;</a></span>watstr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structws__str.html">ws_str</a> watstr </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precipit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>evapo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soildepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fieldc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiltp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_saturation_capacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soil_sand_content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>air_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AuxBioCro_8cpp_source.html#l00604">604</a> of file <a class="el" href="AuxBioCro_8cpp_source.html">AuxBioCro.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;{</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    constexpr <span class="keywordtype">double</span> g = 9.8; <span class="comment">// m / s^2  ##  http://en.wikipedia.org/wiki/Standard_gravity</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordtype">double</span> precipM = precipit * 1e-3; <span class="comment">/* convert precip in mm to m*/</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordtype">double</span> soil_water_fraction = precipM / soildepth + cws;  <span class="comment">// m^3 m^-3</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordtype">double</span> runoff = 0.0;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordtype">double</span> Nleach = 0.0;  <span class="comment">/* Nleach is the NO3 leached. */</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">if</span> (soil_water_fraction &gt; soil_saturation_capacity) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        runoff = (soil_water_fraction - soil_saturation_capacity) * soildepth; <span class="comment">/* This is in meters */</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="comment">/* Here runoff is interpreted as water content exceeding saturation level */</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="comment">/* Need to convert to units used in the Parton et al 1988 paper. */</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="comment">/* The data come in mm/hr and need to be in cm/month */</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        Nleach = runoff / 18 * (0.2 + 0.7 * <a class="code" href="AuxBioCro_8h.html#a32f5636a03443547a8c316772610c4c1a88336b5bb2a1cc21bac7cf33fd451270">sand</a>);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        soil_water_fraction = soil_saturation_capacity;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="comment">/* The density of water is 0.9982 Mg / m^3 at 20 degrees Celsius. */</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">/* evapo is demanded water (Mg / ha) */</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordtype">double</span> npaw = soil_water_fraction - wiltp - evapo / 0.9982 / 1e4 / soildepth;  <span class="comment">// fraction of saturation.</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="comment">/* If demand exceeds supply, the crop is getting close to wilting point and transpiration</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">       will be over estimated. In this one layer model though, the crop is practically dead. */</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">if</span> (npaw &lt; 0) npaw = 0.0;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordtype">double</span> awc = npaw + wiltp;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">/* Calculating the soil water potential based on equations from Norman and Campbell */</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">/* tmp.psim = soTexS.air_entry * pow((awc/soTexS.fieldc*1.1),-soTexS.b); */</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="comment">/* New version of the soil water potential is based on</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">     * &quot;Dynamic Simulation of Water Deficit Effects upon Maize Yield&quot; R. F. Grant Agricultural Systems. 33(1990) 13-39. */</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <a class="code" href="structws__str.html">ws_str</a> tmp;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    tmp.<a class="code" href="structws__str.html#a0ca074c3b977c89e64289641c5056021">psim</a> = -exp(log(0.033) + (log(fieldc) - log(awc)) / (log(fieldc) - log(wiltp)) * (log(1.5) - log(0.033))) * 1e3; <span class="comment">/* This last term converts from MPa to kPa */</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">/* This is drainage */</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">if</span> (awc &gt; fieldc) {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordtype">double</span> K_psim = Ks * pow((air_entry / tmp.<a class="code" href="structws__str.html#a0ca074c3b977c89e64289641c5056021">psim</a>), 2 + 3 / b); <span class="comment">/* This is hydraulic conductivity */</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordtype">double</span> J_w = -K_psim * (-tmp.<a class="code" href="structws__str.html#a0ca074c3b977c89e64289641c5056021">psim</a> / (soildepth * 0.5)) - g * K_psim; <span class="comment">/*  Campbell, pg 129 do not ignore the graviational effect. I multiply soil depth by 0.5 to calculate the average depth */</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="keywordtype">double</span> drainage = J_w * 3600 * 0.9982 * 1e-3; <span class="comment">/* This is flow in m^3 / (m^2 * hr). */</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        awc = awc + drainage / soildepth;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    tmp.<a class="code" href="structws__str.html#aa26f0c560619be1db558875f15fc7419">awc</a> = awc;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    tmp.<a class="code" href="structws__str.html#a7160f2549e1fd6eb443f25f735f266ce">runoff</a> = runoff;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    tmp.<a class="code" href="structws__str.html#adb12cb7c4d83c85849de127132bca5d1">Nleach</a> = Nleach;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">return</span> tmp;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5f0fc680176f312e47c32701ce779f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5f0fc680176f312e47c32701ce779f7">&#9670;&nbsp;</a></span>WINDprof()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void WINDprof </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>wind_speed_profile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RH and Wind profile function</p>
<p>Preconditions: <code>WindSpeed</code> is non-negative. <code>LAI</code> is non-negative <code>nlayers</code> is at least 1 and at most MAXLAY. <code>wind_speed_profile</code> is an array of at least size <code>nlayers</code>. </p>

<p class="definition">Definition at line <a class="el" href="AuxBioCro_8cpp_source.html#l00233">233</a> of file <a class="el" href="AuxBioCro_8cpp_source.html">AuxBioCro.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;{</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    constexpr <span class="keywordtype">double</span> k = 0.7;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">double</span> LI = LAI / nlayers;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nlayers; ++i)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordtype">double</span> CumLAI = LI * (i + 1);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        wind_speed_profile[i] = WindSpeed * exp(-k * (CumLAI - LI));</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="c3CanAC_8cpp_source.html#l00004">c3CanAC()</a>, <a class="el" href="CanAC_8cpp_source.html#l00004">CanAC()</a>, <a class="el" href="canac__with__collatz_8hpp_source.html#l00011">newCanAC()</a>, and <a class="el" href="multilayer__canopy__properties_8h_source.html#l00184">multilayer_canopy_properties::run()</a>.</p>
<div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="BioCro_8h_ad5f0fc680176f312e47c32701ce779f7_icgraph.png" border="0" usemap="#BioCro_8h_ad5f0fc680176f312e47c32701ce779f7_icgraph" alt=""/></div>
<map name="BioCro_8h_ad5f0fc680176f312e47c32701ce779f7_icgraph" id="BioCro_8h_ad5f0fc680176f312e47c32701ce779f7_icgraph">
<area shape="rect" title=" " alt="" coords="267,81,345,108"/>
<area shape="rect" href="c3CanAC_8cpp.html#abe33cbe09472254ce42dc5ff9f397dd1" title=" " alt="" coords="73,5,151,32"/>
<area shape="rect" href="CanAC_8cpp.html#a201d4294ee9d1b27817aea11f9e53e30" title=" " alt="" coords="81,56,143,83"/>
<area shape="rect" href="canac__with__collatz_8hpp.html#a80bef649007309c406cdbc790a9ef36b" title=" " alt="" coords="69,107,155,133"/>
<area shape="rect" href="classmultilayer__canopy__properties.html#a12f0b07cdb6505cf1cfc91773b9e1fd4" title=" " alt="" coords="5,157,219,184"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aAuxBioCro_8cpp_html_a6380d8cd4192408df76baefe6b369a70"><div class="ttname"><a href="AuxBioCro_8cpp.html#a6380d8cd4192408df76baefe6b369a70">TempToDdryA</a></div><div class="ttdeci">double TempToDdryA(double air_temperature)</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8cpp_source.html#l00284">AuxBioCro.cpp:284</a></div></div>
<div class="ttc" id="astructrd__str_html"><div class="ttname"><a href="structrd__str.html">rd_str</a></div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00137">AuxBioCro.h:137</a></div></div>
<div class="ttc" id="astructsoilML__str_html_a7f3063e129dc6591454f7b5050eb3d6c"><div class="ttname"><a href="structsoilML__str.html#a7f3063e129dc6591454f7b5050eb3d6c">soilML_str::cws</a></div><div class="ttdeci">double cws[MAXLAY]</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00065">AuxBioCro.h:65</a></div></div>
<div class="ttc" id="astructLight__profile_html_a49cce1a633a8cb676490a30f16b5d761"><div class="ttname"><a href="structLight__profile.html#a49cce1a633a8cb676490a30f16b5d761">Light_profile::scattered_irradiance</a></div><div class="ttdeci">double scattered_irradiance[MAXLAY]</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00030">AuxBioCro.h:30</a></div></div>
<div class="ttc" id="astructCan__Str_html_af806a0ccf68200e30014c08ed1a903ed"><div class="ttname"><a href="structCan__Str.html#af806a0ccf68200e30014c08ed1a903ed">Can_Str::Assim</a></div><div class="ttdeci">double Assim</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00046">AuxBioCro.h:46</a></div></div>
<div class="ttc" id="astructws__str_html_a7160f2549e1fd6eb443f25f735f266ce"><div class="ttname"><a href="structws__str.html#a7160f2549e1fd6eb443f25f735f266ce">ws_str::runoff</a></div><div class="ttdeci">double runoff</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00058">AuxBioCro.h:58</a></div></div>
<div class="ttc" id="astructsoilML__str_html_aa4ad1174e804109cf6b5c675c37b3f8c"><div class="ttname"><a href="structsoilML__str.html#aa4ad1174e804109cf6b5c675c37b3f8c">soilML_str::drainage</a></div><div class="ttdeci">double drainage</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00066">AuxBioCro.h:66</a></div></div>
<div class="ttc" id="astructsoilML__str_html_a4ff288d6741c98f41855d489942ab1af"><div class="ttname"><a href="structsoilML__str.html#a4ff288d6741c98f41855d489942ab1af">soilML_str::rootDist</a></div><div class="ttdeci">double rootDist[MAXLAY]</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00069">AuxBioCro.h:69</a></div></div>
<div class="ttc" id="astructc3__str_html_a0d2c3391dcf87e250d4f95b44c3bc0e6"><div class="ttname"><a href="structc3__str.html#a0d2c3391dcf87e250d4f95b44c3bc0e6">c3_str::GrossAssim</a></div><div class="ttdeci">double GrossAssim</div><div class="ttdef"><b>Definition:</b> <a href="c3photo_8hpp_source.html#l00012">c3photo.hpp:12</a></div></div>
<div class="ttc" id="aAuxBioCro_8cpp_html_a81eccf5a903a575f17d799d959397f61"><div class="ttname"><a href="AuxBioCro_8cpp.html#a81eccf5a903a575f17d799d959397f61">cos_zenith_angle</a></div><div class="ttdeci">double cos_zenith_angle(const double latitude, const int day_of_year, const double hour_of_day)</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8cpp_source.html#l00072">AuxBioCro.cpp:72</a></div></div>
<div class="ttc" id="astructnitroParms_html_a6ec6c8e941790e6cffb91bcc9916df67"><div class="ttname"><a href="structnitroParms.html#a6ec6c8e941790e6cffb91bcc9916df67">nitroParms::alphab0</a></div><div class="ttdeci">double alphab0</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00160">AuxBioCro.h:160</a></div></div>
<div class="ttc" id="aAuxBioCro_8cpp_html_ada4de667caf80cb05fccaff44cccb9b1"><div class="ttname"><a href="AuxBioCro_8cpp.html#ada4de667caf80cb05fccaff44cccb9b1">rootDist</a></div><div class="ttdeci">struct rd_str rootDist(int n_layers, double rootDepth, double *depths, double rfl)</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8cpp_source.html#l00903">AuxBioCro.cpp:922</a></div></div>
<div class="ttc" id="ac3photo_8cpp_html_a4889758656320bc9290988b4dd5dcec2"><div class="ttname"><a href="c3photo_8cpp.html#a4889758656320bc9290988b4dd5dcec2">c3photoC</a></div><div class="ttdeci">struct c3_str c3photoC(double _Qp, double _Tleaf, double RH, double _Vcmax0, double _Jmax, double _Rd0, double bb0, double bb1, double Ca, double _O2, double thet, double StomWS, int water_stress_approach, double electrons_per_carboxylation, double electrons_per_oxygenation)</div><div class="ttdef"><b>Definition:</b> <a href="c3photo_8cpp_source.html#l00021">c3photo.cpp:27</a></div></div>
<div class="ttc" id="aAuxBioCro_8h_html_a57179778cb6aed95fb9f484b55873d6f"><div class="ttname"><a href="AuxBioCro_8h.html#a57179778cb6aed95fb9f484b55873d6f">MAXLAY</a></div><div class="ttdeci">#define MAXLAY</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00018">AuxBioCro.h:17</a></div></div>
<div class="ttc" id="aAuxBioCro_8cpp_html_ac010f205c5523680171638102192ce39"><div class="ttname"><a href="AuxBioCro_8cpp.html#ac010f205c5523680171638102192ce39">leaf_boundary_layer_conductance</a></div><div class="ttdeci">double leaf_boundary_layer_conductance(double windspeed, double leafwidth, double air_temperature, double delta_t, double stomcond, double water_vapor_pressure)</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8cpp_source.html#l00486">AuxBioCro.cpp:486</a></div></div>
<div class="ttc" id="astructCan__Str_html_a3e32f6d12a6771e23ff40eff5796e26f"><div class="ttname"><a href="structCan__Str.html#a3e32f6d12a6771e23ff40eff5796e26f">Can_Str::canopy_conductance</a></div><div class="ttdeci">double canopy_conductance</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00052">AuxBioCro.h:52</a></div></div>
<div class="ttc" id="astructET__Str_html"><div class="ttname"><a href="structET__Str.html">ET_Str</a></div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00038">AuxBioCro.h:38</a></div></div>
<div class="ttc" id="astructLight__model_html"><div class="ttname"><a href="structLight__model.html">Light_model</a></div><div class="ttdef"><b>Definition:</b> <a href="BioCro_8h_source.html#l00009">BioCro.h:9</a></div></div>
<div class="ttc" id="aAuxBioCro_8cpp_html_ac5f31df2b025300918f031bf8f1e51d9"><div class="ttname"><a href="AuxBioCro_8cpp.html#ac5f31df2b025300918f031bf8f1e51d9">lightME</a></div><div class="ttdeci">Light_model lightME(const double latitude, const int day_of_year, const double hour_of_day)</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8cpp_source.html#l00095">AuxBioCro.cpp:95</a></div></div>
<div class="ttc" id="astructCan__Str_html"><div class="ttname"><a href="structCan__Str.html">Can_Str</a></div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00045">AuxBioCro.h:45</a></div></div>
<div class="ttc" id="astructLight__profile_html_a2f8231e1e3f6b0c04e8a08ddcc419e03"><div class="ttname"><a href="structLight__profile.html#a2f8231e1e3f6b0c04e8a08ddcc419e03">Light_profile::direct_irradiance</a></div><div class="ttdeci">double direct_irradiance[MAXLAY]</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00029">AuxBioCro.h:29</a></div></div>
<div class="ttc" id="astructLight__profile_html_a3a64c8a4ce00e9190ec3f3b8b7233817"><div class="ttname"><a href="structLight__profile.html#a3a64c8a4ce00e9190ec3f3b8b7233817">Light_profile::diffuse_irradiance</a></div><div class="ttdeci">double diffuse_irradiance[MAXLAY]</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00031">AuxBioCro.h:31</a></div></div>
<div class="ttc" id="astructLight__model_html_a8ad7918d4aada10f0c64e073da9c4ff4"><div class="ttname"><a href="structLight__model.html#a8ad7918d4aada10f0c64e073da9c4ff4">Light_model::cosine_zenith_angle</a></div><div class="ttdeci">double cosine_zenith_angle</div><div class="ttdef"><b>Definition:</b> <a href="BioCro_8h_source.html#l00012">BioCro.h:12</a></div></div>
<div class="ttc" id="astructc4__str_html"><div class="ttname"><a href="structc4__str.html">c4_str</a></div><div class="ttdef"><b>Definition:</b> <a href="c4photo_8h_source.html#l00008">c4photo.h:8</a></div></div>
<div class="ttc" id="astructsoilML__str_html_a01cde156faa3f11579218b3759f5f126"><div class="ttname"><a href="structsoilML__str.html#a01cde156faa3f11579218b3759f5f126">soilML_str::Nleach</a></div><div class="ttdeci">double Nleach</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00067">AuxBioCro.h:67</a></div></div>
<div class="ttc" id="aAuxBioCro_8cpp_html_ad5f0fc680176f312e47c32701ce779f7"><div class="ttname"><a href="AuxBioCro_8cpp.html#ad5f0fc680176f312e47c32701ce779f7">WINDprof</a></div><div class="ttdeci">void WINDprof(double WindSpeed, double LAI, int nlayers, double *wind_speed_profile)</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8cpp_source.html#l00233">AuxBioCro.cpp:233</a></div></div>
<div class="ttc" id="aAuxBioCro_8cpp_html_a5272d35a20edaa0de28ca4ccae5b10a5"><div class="ttname"><a href="AuxBioCro_8cpp.html#a5272d35a20edaa0de28ca4ccae5b10a5">EvapoTrans2</a></div><div class="ttdeci">struct ET_Str EvapoTrans2(const double Rad, const double Iave, const double airTemp, const double RH, double WindSpeed, const double LeafAreaIndex, double CanopyHeight, const double stomatal_conductance, const double leaf_width, const int eteq)</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8cpp_source.html#l00325">AuxBioCro.cpp:335</a></div></div>
<div class="ttc" id="astructLight__model_html_a5ecfb901306b14488b8b3e2e851f63b6"><div class="ttname"><a href="structLight__model.html#a5ecfb901306b14488b8b3e2e851f63b6">Light_model::diffuse_irradiance_fraction</a></div><div class="ttdeci">double diffuse_irradiance_fraction</div><div class="ttdef"><b>Definition:</b> <a href="BioCro_8h_source.html#l00011">BioCro.h:11</a></div></div>
<div class="ttc" id="aAuxBioCro_8cpp_html_a29eacaa214f1899c9df199ac80d0e1ca"><div class="ttname"><a href="AuxBioCro_8cpp.html#a29eacaa214f1899c9df199ac80d0e1ca">sunML</a></div><div class="ttdeci">Light_profile sunML(double Idir, double Idiff, double LAI, int nlayers, double cosTheta, double kd, double chil, double heightf)</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8cpp_source.html#l00149">AuxBioCro.cpp:149</a></div></div>
<div class="ttc" id="astructc3__str_html_a2fcc3787ac1ca5dd5be990fc00fb92f6"><div class="ttname"><a href="structc3__str.html#a2fcc3787ac1ca5dd5be990fc00fb92f6">c3_str::Gs</a></div><div class="ttdeci">double Gs</div><div class="ttdef"><b>Definition:</b> <a href="c3photo_8hpp_source.html#l00010">c3photo.hpp:10</a></div></div>
<div class="ttc" id="astructsoilML__str_html_a18a83a9cab2ee1fe35ec98a9a3a7a7c8"><div class="ttname"><a href="structsoilML__str.html#a18a83a9cab2ee1fe35ec98a9a3a7a7c8">soilML_str::rcoefPhoto</a></div><div class="ttdeci">double rcoefPhoto</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00063">AuxBioCro.h:63</a></div></div>
<div class="ttc" id="astructws__str_html_aa26f0c560619be1db558875f15fc7419"><div class="ttname"><a href="structws__str.html#aa26f0c560619be1db558875f15fc7419">ws_str::awc</a></div><div class="ttdeci">double awc</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00056">AuxBioCro.h:56</a></div></div>
<div class="ttc" id="aBioCro_8h_html_a6fa022454f0de8f427c38ad0cbec1314"><div class="ttname"><a href="BioCro_8h.html#a6fa022454f0de8f427c38ad0cbec1314">c3EvapoTrans</a></div><div class="ttdeci">struct ET_Str c3EvapoTrans(double Itot, double Airtemperature, double RH, double WindSpeed, double CanopyHeight, double stomtal_conductance)</div><div class="ttdef"><b>Definition:</b> <a href="c3EvapoTrans_8cpp_source.html#l00001">c3EvapoTrans.cpp:18</a></div></div>
<div class="ttc" id="astructc4__str_html_a928a57132388ea027d82a5d841d29ea3"><div class="ttname"><a href="structc4__str.html#a928a57132388ea027d82a5d841d29ea3">c4_str::GrossAssim</a></div><div class="ttdeci">double GrossAssim</div><div class="ttdef"><b>Definition:</b> <a href="c4photo_8h_source.html#l00012">c4photo.h:12</a></div></div>
<div class="ttc" id="astructLight__profile_html_a5ab1c660a6d5af30163325103043a419"><div class="ttname"><a href="structLight__profile.html#a5ab1c660a6d5af30163325103043a419">Light_profile::sunlit_fraction</a></div><div class="ttdeci">double sunlit_fraction[MAXLAY]</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00033">AuxBioCro.h:33</a></div></div>
<div class="ttc" id="astructc4__str_html_a29de44c5705baf89ff902918ed0eebee"><div class="ttname"><a href="structc4__str.html#a29de44c5705baf89ff902918ed0eebee">c4_str::Gs</a></div><div class="ttdeci">double Gs</div><div class="ttdef"><b>Definition:</b> <a href="c4photo_8h_source.html#l00010">c4photo.h:10</a></div></div>
<div class="ttc" id="aAuxBioCro_8cpp_html_a117fba2c85ba6d52345e7cefc05a43ff"><div class="ttname"><a href="AuxBioCro_8cpp.html#a117fba2c85ba6d52345e7cefc05a43ff">saturation_vapor_pressure</a></div><div class="ttdeci">double saturation_vapor_pressure(double air_temperature)</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8cpp_source.html#l00325">AuxBioCro.cpp:325</a></div></div>
<div class="ttc" id="aAuxBioCro_8cpp_html_a2905c23b422ad454d9577841ca594d0d"><div class="ttname"><a href="AuxBioCro_8cpp.html#a2905c23b422ad454d9577841ca594d0d">LNprof</a></div><div class="ttdeci">void LNprof(double LeafN, double LAI, int nlayers, double kpLN, double *leafN_profile)</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8cpp_source.html#l00274">AuxBioCro.cpp:274</a></div></div>
<div class="ttc" id="astructc4__str_html_ade490c8a63b9554b0ee7d88ee7f8153b"><div class="ttname"><a href="structc4__str.html#ade490c8a63b9554b0ee7d88ee7f8153b">c4_str::Assim</a></div><div class="ttdeci">double Assim</div><div class="ttdef"><b>Definition:</b> <a href="c4photo_8h_source.html#l00009">c4photo.h:9</a></div></div>
<div class="ttc" id="aAuxBioCro_8cpp_html_a05f381bbff6170709a8d0e2e34f4556a"><div class="ttname"><a href="AuxBioCro_8cpp.html#a05f381bbff6170709a8d0e2e34f4556a">TempToSFS</a></div><div class="ttdeci">double TempToSFS(double air_temperature)</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8cpp_source.html#l00319">AuxBioCro.cpp:319</a></div></div>
<div class="ttc" id="astructc3__str_html_a859d76f4c4e8c6a96e34e9b99f2857dc"><div class="ttname"><a href="structc3__str.html#a859d76f4c4e8c6a96e34e9b99f2857dc">c3_str::Assim</a></div><div class="ttdeci">double Assim</div><div class="ttdef"><b>Definition:</b> <a href="c3photo_8hpp_source.html#l00009">c3photo.hpp:9</a></div></div>
<div class="ttc" id="astructnitroParms_html_ab996844d0d28b9ed8324652ef03c7a9f"><div class="ttname"><a href="structnitroParms.html#ab996844d0d28b9ed8324652ef03c7a9f">nitroParms::alphab1</a></div><div class="ttdeci">double alphab1</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00159">AuxBioCro.h:159</a></div></div>
<div class="ttc" id="astructsoilML__str_html_a61a206aa7c24239e09e3d717368665a5"><div class="ttname"><a href="structsoilML__str.html#a61a206aa7c24239e09e3d717368665a5">soilML_str::rcoefSpleaf</a></div><div class="ttdeci">double rcoefSpleaf</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00064">AuxBioCro.h:64</a></div></div>
<div class="ttc" id="astructc3__str_html"><div class="ttname"><a href="structc3__str.html">c3_str</a></div><div class="ttdef"><b>Definition:</b> <a href="c3photo_8hpp_source.html#l00008">c3photo.hpp:8</a></div></div>
<div class="ttc" id="astructET__Str_html_af1313b200fdfaf71c6d4ee070ddeaf8c"><div class="ttname"><a href="structET__Str.html#af1313b200fdfaf71c6d4ee070ddeaf8c">ET_Str::Deltat</a></div><div class="ttdeci">double Deltat</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00042">AuxBioCro.h:42</a></div></div>
<div class="ttc" id="astructLight__profile_html_a424cf9cc81031798184256d14a08786a"><div class="ttname"><a href="structLight__profile.html#a424cf9cc81031798184256d14a08786a">Light_profile::total_irradiance</a></div><div class="ttdeci">double total_irradiance[MAXLAY]</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00032">AuxBioCro.h:32</a></div></div>
<div class="ttc" id="aAuxBioCro_8h_html_a32f5636a03443547a8c316772610c4c1a88336b5bb2a1cc21bac7cf33fd451270"><div class="ttname"><a href="AuxBioCro_8h.html#a32f5636a03443547a8c316772610c4c1a88336b5bb2a1cc21bac7cf33fd451270">SoilType::sand</a></div><div class="ttdeci">@ sand</div></div>
<div class="ttc" id="astructws__str_html_a0ca074c3b977c89e64289641c5056021"><div class="ttname"><a href="structws__str.html#a0ca074c3b977c89e64289641c5056021">ws_str::psim</a></div><div class="ttdeci">double psim</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00057">AuxBioCro.h:57</a></div></div>
<div class="ttc" id="aAuxBioCro_8cpp_html_ae4f33badbbdb16dada45516a54bdc4a0"><div class="ttname"><a href="AuxBioCro_8cpp.html#ae4f33badbbdb16dada45516a54bdc4a0">SoilEvapo</a></div><div class="ttdeci">double SoilEvapo(double LAI, double k, double air_temperature, double ppfd, double soil_water_content, double fieldc, double wiltp, double winds, double RelH, double rsec, double soil_clod_size, double soil_reflectance, double soil_transmission, double specific_heat, double stefan_boltzman)</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8cpp_source.html#l00536">AuxBioCro.cpp:536</a></div></div>
<div class="ttc" id="astructLight__profile_html"><div class="ttname"><a href="structLight__profile.html">Light_profile</a></div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00028">AuxBioCro.h:28</a></div></div>
<div class="ttc" id="astructrd__str_html_a72c08ee2378ad2245439d54ff775b4de"><div class="ttname"><a href="structrd__str.html#a72c08ee2378ad2245439d54ff775b4de">rd_str::rootDist</a></div><div class="ttdeci">double rootDist[MAXLAY]</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00138">AuxBioCro.h:138</a></div></div>
<div class="ttc" id="astructsoilML__str_html_ad1c34d3fec2b0784367f785d57906217"><div class="ttname"><a href="structsoilML__str.html#ad1c34d3fec2b0784367f785d57906217">soilML_str::SoilEvapo</a></div><div class="ttdeci">double SoilEvapo</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00068">AuxBioCro.h:68</a></div></div>
<div class="ttc" id="astructnitroParms_html_a1c7f001a6620cba218a735e94dacafc5"><div class="ttname"><a href="structnitroParms.html#a1c7f001a6620cba218a735e94dacafc5">nitroParms::Vmaxb1</a></div><div class="ttdeci">double Vmaxb1</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00157">AuxBioCro.h:157</a></div></div>
<div class="ttc" id="astructLight__profile_html_ab9551f243ec3ef975ebb13d1566aa75a"><div class="ttname"><a href="structLight__profile.html#ab9551f243ec3ef975ebb13d1566aa75a">Light_profile::height</a></div><div class="ttdeci">double height[MAXLAY]</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00035">AuxBioCro.h:35</a></div></div>
<div class="ttc" id="astructCan__Str_html_a652f573fcd65d47a2690915af8966af4"><div class="ttname"><a href="structCan__Str.html#a652f573fcd65d47a2690915af8966af4">Can_Str::result_matrix</a></div><div class="ttdeci">double result_matrix[MAXLAY *21]</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00049">AuxBioCro.h:49</a></div></div>
<div class="ttc" id="astructws__str_html"><div class="ttname"><a href="structws__str.html">ws_str</a></div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00055">AuxBioCro.h:55</a></div></div>
<div class="ttc" id="astructLight__profile_html_a61e74afb9cc127be0696334b9a1ffdc8"><div class="ttname"><a href="structLight__profile.html#a61e74afb9cc127be0696334b9a1ffdc8">Light_profile::shaded_fraction</a></div><div class="ttdeci">double shaded_fraction[MAXLAY]</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00034">AuxBioCro.h:34</a></div></div>
<div class="ttc" id="astructET__Str_html_a6407d50c376c4982344370729ecb5e95"><div class="ttname"><a href="structET__Str.html#a6407d50c376c4982344370729ecb5e95">ET_Str::EPenman</a></div><div class="ttdeci">double EPenman</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00040">AuxBioCro.h:40</a></div></div>
<div class="ttc" id="aAuxBioCro_8cpp_html_ae810651283c6640ef4669d0eede1c942"><div class="ttname"><a href="AuxBioCro_8cpp.html#ae810651283c6640ef4669d0eede1c942">TempToLHV</a></div><div class="ttdeci">double TempToLHV(double air_temperature)</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8cpp_source.html#l00301">AuxBioCro.cpp:301</a></div></div>
<div class="ttc" id="astructnitroParms_html_aafdfebf8e92977c0185a1e4a3155b439"><div class="ttname"><a href="structnitroParms.html#aafdfebf8e92977c0185a1e4a3155b439">nitroParms::Rdb1</a></div><div class="ttdeci">double Rdb1</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00161">AuxBioCro.h:161</a></div></div>
<div class="ttc" id="astructnitroParms_html_ab87cf4969607b3d3afd0bd895b219543"><div class="ttname"><a href="structnitroParms.html#ab87cf4969607b3d3afd0bd895b219543">nitroParms::Rdb0</a></div><div class="ttdeci">double Rdb0</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00162">AuxBioCro.h:162</a></div></div>
<div class="ttc" id="astructsoilML__str_html"><div class="ttname"><a href="structsoilML__str.html">soilML_str</a></div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00062">AuxBioCro.h:62</a></div></div>
<div class="ttc" id="astructET__Str_html_aa5c251e199215e0ab35a58a8e2a34a32"><div class="ttname"><a href="structET__Str.html#aa5c251e199215e0ab35a58a8e2a34a32">ET_Str::EPriestly</a></div><div class="ttdeci">double EPriestly</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00041">AuxBioCro.h:41</a></div></div>
<div class="ttc" id="astructnitroParms_html_af39da18e7964fdbe77fde342dcf97a5b"><div class="ttname"><a href="structnitroParms.html#af39da18e7964fdbe77fde342dcf97a5b">nitroParms::Vmaxb0</a></div><div class="ttdeci">double Vmaxb0</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00158">AuxBioCro.h:158</a></div></div>
<div class="ttc" id="astructws__str_html_adb12cb7c4d83c85849de127132bca5d1"><div class="ttname"><a href="structws__str.html#adb12cb7c4d83c85849de127132bca5d1">ws_str::Nleach</a></div><div class="ttdeci">double Nleach</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00059">AuxBioCro.h:59</a></div></div>
<div class="ttc" id="aAuxBioCro_8cpp_html_aa4d2cdd07093428af4830f4c8afd660c"><div class="ttname"><a href="AuxBioCro_8cpp.html#aa4d2cdd07093428af4830f4c8afd660c">RHprof</a></div><div class="ttdeci">void RHprof(double RH, int nlayers, double *relative_humidity_profile)</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8cpp_source.html#l00255">AuxBioCro.cpp:255</a></div></div>
<div class="ttc" id="ac4photo_8cpp_html_a267a416bf303e187cbab12efcad0227a"><div class="ttname"><a href="c4photo_8cpp.html#a267a416bf303e187cbab12efcad0227a">c4photoC</a></div><div class="ttdeci">struct c4_str c4photoC(double Qp, double leaf_temperature, double relative_humidity, double vmax, double alpha, double kparm, double theta, double beta, double Rd, double bb0, double bb1, double StomaWS, double Ca, int water_stress_approach, double upperT, double lowerT)</div><div class="ttdef"><b>Definition:</b> <a href="c4photo_8cpp_source.html#l00001">c4photo.cpp:15</a></div></div>
<div class="ttc" id="astructET__Str_html_a6459f6ef779feb02861948dc4f4b06f0"><div class="ttname"><a href="structET__Str.html#a6459f6ef779feb02861948dc4f4b06f0">ET_Str::TransR</a></div><div class="ttdeci">double TransR</div><div class="ttdef"><b>Definition:</b> <a href="AuxBioCro_8h_source.html#l00039">AuxBioCro.h:39</a></div></div>
<div class="ttc" id="astructLight__model_html_a29f813f0ce340f3d02748daffbec5200"><div class="ttname"><a href="structLight__model.html#a29f813f0ce340f3d02748daffbec5200">Light_model::direct_irradiance_fraction</a></div><div class="ttdeci">double direct_irradiance_fraction</div><div class="ttdef"><b>Definition:</b> <a href="BioCro_8h_source.html#l00010">BioCro.h:10</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_567355a66c5b87dfe03a58cbdce72993.html">module_library</a></li><li class="navelem"><a class="el" href="BioCro_8h.html">BioCro.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
